{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "2230b9d1_1007114b",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 31,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-12-01T00:02:21Z",
      "side": 1,
      "message": "Same as below, pretty sure we don\u0027t want to fixup this one either, given that this is for EventService",
      "range": {
        "startLine": 31,
        "startChar": 0,
        "endLine": 31,
        "endChar": 18
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2035dfef_3a3d86a4",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 31,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2022-12-01T20:51:20Z",
      "side": 1,
      "message": "I describe this in a latter comment, but it\u0027s not possible to fixup URIs that are not for known redfish resources.  I\u0027ll go ahead and remove it though since \"Destination\" won\u0027t point to a Redfish URI.",
      "parentUuid": "2230b9d1_1007114b",
      "range": {
        "startLine": 31,
        "startChar": 0,
        "endLine": 31,
        "endChar": 18
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "043ad2b0_da5661ad",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 31,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-12-01T21:08:52Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2035dfef_3a3d86a4",
      "range": {
        "startLine": 31,
        "startChar": 0,
        "endLine": 31,
        "endChar": 18
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e44afd8b_e718db96",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 31,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2022-12-01T21:54:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2035dfef_3a3d86a4",
      "range": {
        "startLine": 31,
        "startChar": 0,
        "endLine": 31,
        "endChar": 18
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d60bfcf9_9f9ea1bb",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 34,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-12-01T00:02:21Z",
      "side": 1,
      "message": "I don\u0027t think this is valid odata?",
      "range": {
        "startLine": 34,
        "startChar": 0,
        "endLine": 34,
        "endChar": 35
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f67c76d3_9e034eb2",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 34,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2022-12-01T20:51:20Z",
      "side": 1,
      "message": "Yeah that\u0027s a really weird looking one, but it\u0027s defined in the spec as a \"string (URI)\" so I included it https://www.dmtf.org/sites/default/files/standards/documents/DSP2046_2022.2.pdf#page\u003d47",
      "parentUuid": "d60bfcf9_9f9ea1bb",
      "range": {
        "startLine": 34,
        "startChar": 0,
        "endLine": 34,
        "endChar": 35
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f2f43a22_a5402803",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 34,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-12-01T21:08:52Z",
      "side": 1,
      "message": "Interesting.... I\u0027m pretty sure that\u0027s a typo in the schema guide generation.  Lets leave it off for now, and I\u0027ll file a bug with DMTF.\n\nhttps://github.com/DMTF/Redfish/issues/5372",
      "parentUuid": "f67c76d3_9e034eb2",
      "range": {
        "startLine": 34,
        "startChar": 0,
        "endLine": 34,
        "endChar": 35
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "76d9e717_2e18fcc9",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 34,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2022-12-01T21:54:30Z",
      "side": 1,
      "message": "Alright I\u0027ve commented it out while the bug works its way through.",
      "parentUuid": "f2f43a22_a5402803",
      "range": {
        "startLine": 34,
        "startChar": 0,
        "endLine": 34,
        "endChar": 35
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "567e9443_da745a6d",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 34,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-12-05T17:27:15Z",
      "side": 1,
      "message": "Yep, Jeff pushed a fix to the documentation.  WE should be good now.",
      "parentUuid": "76d9e717_2e18fcc9",
      "range": {
        "startLine": 34,
        "startChar": 0,
        "endLine": 34,
        "endChar": 35
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4e4b64a4_a448d13d",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 34,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2022-12-05T23:39:08Z",
      "side": 1,
      "message": "Nice then I\u0027ll completely remove it instead of just commenting it out.",
      "parentUuid": "567e9443_da745a6d",
      "range": {
        "startLine": 34,
        "startChar": 0,
        "endLine": 34,
        "endChar": 35
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "14e32c29_72449b47",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 37,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-12-01T00:02:21Z",
      "side": 1,
      "message": "Aggregating async Tasks needs more thought than this.  I suspect we should omit this for now, but very likely the aggregator TaskService will need a special implementation for aggregation.",
      "range": {
        "startLine": 37,
        "startChar": 5,
        "endLine": 37,
        "endChar": 16
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "135d813c_951c5b01",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 37,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2022-12-01T21:54:30Z",
      "side": 1,
      "message": "I\u0027m not understanding the concern.  TaskMonitor only appears in responses from /redfish/v1/TaskService/Tasks/{TaskId}.  That can be an aggregated resource since Tasks is a top level collection.\n\nThe example in the schema is:\n\"TaskMonitor\": \"/taskmon/545\"\n\nThat path would not get modified by the prefix fixing logic.",
      "parentUuid": "14e32c29_72449b47",
      "range": {
        "startLine": 37,
        "startChar": 5,
        "endLine": 37,
        "endChar": 16
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3aaf892c_c8237788",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 37,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-12-05T17:37:50Z",
      "side": 1,
      "message": "TaskMonitor points to a URI that is outside of the redfish tree, and has task monitor semantics, rather than normal redfish tree semantics.  If you aggregate a TaskMonitor URI per the normal rules, the TaskMonitor will be broken and non-functional.\n\nIn theory, for async tasks, the aggregator connection needs to have special handling for it, and integrate the Async tasks into the aggregated collection.  This is likely non-trivial, but will need to be done at some point.",
      "parentUuid": "135d813c_951c5b01",
      "range": {
        "startLine": 37,
        "startChar": 5,
        "endLine": 37,
        "endChar": 16
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9cba59cb_5e0782a2",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 37,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2022-12-05T23:39:08Z",
      "side": 1,
      "message": "\u003e TaskMonitor points to a URI that is outside of the redfish tree, and has task monitor semantics, rather than normal redfish tree semantics\nThat doesn\u0027t seem to always be the case.  Right now we set TaskMonitor as /redfish/v1/TaskService/Tasks/\u003cTaskId\u003e/Monitor https://github.com/openbmc/bmcweb/blob/master/redfish-core/lib/task.hpp#L407-L411.  We would want to fixup that link since we\u0027ll be able to aggregate it when this chain of patches lands.\n\n\u003e If you aggregate a TaskMonitor URI per the normal rules, the TaskMonitor will be broken and non-functional.\nWe won\u0027t aggregate any URI that is not part of a top level collection in the Redfish tree.  If it\u0027s an external URI then the prefix fixing logic would ignore it anyway.  If there\u0027s a situation where the URI is not in the redfish tree, but it\u0027s somehow local to the satellite BMC, then I\u0027m not sure how we\u0027d handle aggregating requests to it.  BMCWeb wouldn\u0027t normally handle ones outside of the redfish tree.\n\n\u003e In theory, for async tasks, the aggregator connection needs to have special handling for it, and integrate the Async tasks into the aggregated collection.  This is likely non-trivial, but will need to be done at some point.\nThat should get implemented as part of https://gerrit.openbmc.org/c/openbmc/bmcweb/+/59004/10.  The URI for a given satellite Task will be /redfish/v1/TaskService/Tasks/{TaskId}.  /redfish/v1/TaskService/Tasks is a top level collection and as such the satellite task will be exposed as /redfish/v1/TaskService/Tasks/{prefix}_{TaskID}.",
      "parentUuid": "3aaf892c_c8237788",
      "range": {
        "startLine": 37,
        "startChar": 5,
        "endLine": 37,
        "endChar": 16
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4a6fe3b5_1a468a5d",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 37,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-12-06T16:23:26Z",
      "side": 1,
      "message": "\u003e \u003e TaskMonitor points to a URI that is outside of the redfish tree, and has task monitor semantics, rather than normal redfish tree semantics\n\u003e That doesn\u0027t seem to always be the case.  Right now we set TaskMonitor as /redfish/v1/TaskService/Tasks/\u003cTaskId\u003e/Monitor https://github.com/openbmc/bmcweb/blob/master/redfish-core/lib/task.hpp#L407-L411.  We would want to fixup that link since we\u0027ll be able to aggregate it when this chain of patches lands.\n\nRight, but you have to realize that /redfish/v1/TaskService/Tasks/\u003cTaskId\u003e/Monitor is something that openbmc picked, and while the URI looks like it\u0027s in the redfish tree (which we do for peoples sanity) it\u0027s actually not a Redfish CRUD node.  With that said, maybe aggregating it would give the right behavior?  This needs more thought.\n\n\u003e \n\u003e \u003e If you aggregate a TaskMonitor URI per the normal rules, the TaskMonitor will be broken and non-functional.\n\u003e We won\u0027t aggregate any URI that is not part of a top level collection in the Redfish tree.  If it\u0027s an external URI then the prefix fixing logic would ignore it anyway.  If there\u0027s a situation where the URI is not in the redfish tree, but it\u0027s somehow local to the satellite BMC, then I\u0027m not sure how we\u0027d handle aggregating requests to it.  BMCWeb wouldn\u0027t normally handle ones outside of the redfish tree.\n\nI suspect we need to just not aggregate it or omit it, but lets discuss in a future patch.\n\n\u003e \n\u003e \u003e In theory, for async tasks, the aggregator connection needs to have special handling for it, and integrate the Async tasks into the aggregated collection.  This is likely non-trivial, but will need to be done at some point.\n\u003e That should get implemented as part of https://gerrit.openbmc.org/c/openbmc/bmcweb/+/59004/10.  The URI for a given satellite Task will be /redfish/v1/TaskService/Tasks/{TaskId}.  /redfish/v1/TaskService/Tasks is a top level collection and as such the satellite task will be exposed as /redfish/v1/TaskService/Tasks/{prefix}_{TaskID}.\n\nRight, but the task monitor isn\u0027t going to forward correctly, because the task monitor could be something totally different.\n\noh well, problem for another day.  I\u0027m satisfied.",
      "parentUuid": "9cba59cb_5e0782a2",
      "range": {
        "startLine": 37,
        "startChar": 5,
        "endLine": 37,
        "endChar": 16
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a5e8ac2f_9f15a2a9",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 8
      },
      "lineNbr": 37,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2022-12-07T06:56:08Z",
      "side": 1,
      "message": "\u003e oh well, problem for another day.  I\u0027m satisfied.\n\nSGTM.  This will likely come up again as part of the patch I previously linked which adds support for all top level collections.  Per offline discussion, the play might be to just completely strip TaskMonitor from responses and then create a future patch which would implement some type of special handling for the URI.",
      "parentUuid": "4a6fe3b5_1a468a5d",
      "range": {
        "startLine": 37,
        "startChar": 5,
        "endLine": 37,
        "endChar": 16
      },
      "revId": "e04a738854311b63155817223e14cf0432ad3d86",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}