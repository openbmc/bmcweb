{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "4e89ca75_cf11a1c4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 21
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-08-22T22:57:01Z",
      "side": 1,
      "message": "This code looks fine to me.  Looking for others to help review/test",
      "revId": "36a46b88f53b2a9319f3b21bfd95a7003f8c5d7d",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1073b7f3_3f73b8a8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 21
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-08-22T22:59:59Z",
      "side": 1,
      "message": "Code looks correct.  Commit message could use some more details on the other commits required to make this work, and which commits it was tested against, but code now looks fine to me.",
      "revId": "36a46b88f53b2a9319f3b21bfd95a7003f8c5d7d",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4b5b25e9_011c4edb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 21
      },
      "lineNbr": 0,
      "author": {
        "id": 1000350
      },
      "writtenOn": "2024-08-23T13:22:11Z",
      "side": 1,
      "message": "Hi Ed\ncode looks good. I have tested this latest patch set, it works as expected.\n\nHere is test results\n\nBasic redfish login works\ncurl --insecure -H \"Content-Type: application/json\" -X POST -D headers.txt https://${bmc}/redfish/v1/SessionService/Sessions -d \u0027{\"UserName\" :\"root\", \"Password\": \"0penBmc\"}\u0027\n{\n  \"@odata.id\": \"/redfish/v1/SessionService/Sessions/9qPyD09C1Y\",\n  \"@odata.type\": \"#Session.v1_7_0.Session\",\n  \"ClientOriginIPAddress\": \"10.0.2.2\",\n  \"Description\": \"Manager User Session\",\n  \"Id\": \"9qPyD09C1Y\",\n  \"Name\": \"User Session\",\n  \"Roles\": [\n    \"Administrator\"\n  ],\n  \"UserName\": \"root\"\n}\n\nIn case random Token passed, Token parameter will be ignored when google-authenticator is not configured, authentication still works.\ncurl --insecure -H \"Content-Type: application/json\" -X POST -D headers.txt https://${bmc}/redfish/v1/SessionService/Sessions -d \u0027{\"UserName\" :\"root\", \"Password\": \"0penBmc\",\"Token\": \"123456\"}\u0027\n{\n  \"@odata.id\": \"/redfish/v1/SessionService/Sessions/dEp900GWc9\",\n  \"@odata.type\": \"#Session.v1_7_0.Session\",\n  \"ClientOriginIPAddress\": \"10.0.2.2\",\n  \"Description\": \"Manager User Session\",\n  \"Id\": \"dEp900GWc9\",\n  \"Name\": \"User Session\",\n  \"Roles\": [\n    \"Administrator\"\n  ],\n  \"UserName\": \"root\"\n}\n\nTested with google-authenticator configuration:\n\nAuthentication works with valid TOTP token\ncurl --insecure -H \"Content-Type: application/json\" -X POST -D headers.txt https://${bmc}/redfish/v1/SessionService/Sessions -d \u0027{\"UserName\" :\"root\", \"Password\": \"0penBmc\",\"Token\": \"831050\"}\u0027\n{\n  \"@odata.id\": \"/redfish/v1/SessionService/Sessions/JtotnXielJ\",\n  \"@odata.type\": \"#Session.v1_7_0.Session\",\n  \"ClientOriginIPAddress\": \"10.0.2.2\",\n  \"Description\": \"Manager User Session\",\n  \"Id\": \"JtotnXielJ\",\n  \"Name\": \"User Session\",\n  \"Roles\": [\n    \"Administrator\"\n  ],\n  \"UserName\": \"root\"\n}\n\nAuthentication fails with invalid TOTP token\n\ncurl --insecure -H \"Content-Type: application/json\" -X POST -D headers.txt https://${bmc}/redfish/v1/SessionService/Sessions -d \u0027{\"UserName\" :\"root\", \"Password\": \"0penBmc\",\"Token\": \"831050\"}\u0027\n{\n  \"error\": {\n    \"@Message.ExtendedInfo\": [\n      {\n        \"@odata.type\": \"#Message.v1_1_1.Message\",\n        \"Message\": \"While accessing the resource at \u0027/redfish/v1/SessionService/Sessions\u0027, the service received an authorization error \u0027Invalid username or password\u0027.\",\n        \"MessageArgs\": [\n          \"/redfish/v1/SessionService/Sessions\",\n          \"Invalid username or password\"\n        ],\n        \"MessageId\": \"Base.1.18.1.ResourceAtUriUnauthorized\",\n        \"MessageSeverity\": \"Critical\",\n        \"Resolution\": \"Ensure that the appropriate access is provided for the service in order for it to access the URI.\"\n      }\n    ],\n    \"code\": \"Base.1.18.1.ResourceAtUriUnauthorized\",\n    \"message\": \"While accessing the resource at \u0027/redfish/v1/SessionService/Sessions\u0027, the service received an authorization error \u0027Invalid username or password\u0027.\"\n  }\n}\nlets get this commit merged",
      "parentUuid": "4e89ca75_cf11a1c4",
      "revId": "36a46b88f53b2a9319f3b21bfd95a7003f8c5d7d",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8aa567aa_62e0420f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 21
      },
      "lineNbr": 0,
      "author": {
        "id": 1000350
      },
      "writtenOn": "2024-08-23T13:29:20Z",
      "side": 1,
      "message": "I think we need to modify this error message to include Token parameter as well\n\"Invalid username or password or token\"",
      "parentUuid": "4b5b25e9_011c4edb",
      "revId": "36a46b88f53b2a9319f3b21bfd95a7003f8c5d7d",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4e2f3d6_0a79b6d6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 21
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-08-23T15:10:57Z",
      "side": 1,
      "message": "we should update to just \"invalid credentials\" or something like that.  We don\u0027t know if a token was provided.\n\nFWIW, I\"m ok with the message as it is.  the Token is a kind of \"Password\"",
      "parentUuid": "8aa567aa_62e0420f",
      "revId": "36a46b88f53b2a9319f3b21bfd95a7003f8c5d7d",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6fd43dc0_a79f1ffa",
        "filename": "include/pam_authenticate.hpp",
        "patchSetId": 21
      },
      "lineNbr": 60,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-08-22T22:56:48Z",
      "side": 1,
      "message": "FYI, I changed these to string view, and the next line to starts_with.  Please review and test if it still works for you.",
      "range": {
        "startLine": 60,
        "startChar": 31,
        "endLine": 60,
        "endChar": 42
      },
      "revId": "36a46b88f53b2a9319f3b21bfd95a7003f8c5d7d",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}