{
  "comments": [
    {
      "key": {
        "uuid": "4be07428_45effd8b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-04-02T20:43:07Z",
      "side": 1,
      "message": "Please don\u0027t wrap your commits by hand, or if you do, please obey  50/72",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 11,
        "endChar": 22
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c2f55d3d_c19b1333",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 11,
      "author": {
        "id": 1000400
      },
      "writtenOn": "2021-04-06T10:05:33Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4be07428_45effd8b",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 11,
        "endChar": 22
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8743f0ba_56f9c77b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-04-02T20:43:07Z",
      "side": 1,
      "message": "HealthPopulate seems to be how we handle this properly in other places.  Why wouldn\u0027t we use that here?",
      "range": {
        "startLine": 14,
        "startChar": 0,
        "endLine": 14,
        "endChar": 73
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f70f33eb_2cd91049",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-04-05T14:13:23Z",
      "side": 1,
      "message": "HealthPopulate is only used by some resources, I think more resources don\u0027t use it than use it. :/ \n\nI don\u0027t see HealthPopulate looking at OperationalStatus, Operational Status is mentioned in the design though\nhttps://github.com/openbmc/docs/blob/919a7b6816a5f16aa72d298e81e0756d95d5031e/designs/redfish-health-rolllup.md#proposed-design\n\nhttps://github.com/openbmc/phosphor-dbus-interfaces/blob/32304979b404c24e32f195d08c667e65b9b34695/xyz/openbmc_project/State/Decorator/OperationalStatus.interface.yaml\n\nIf we decide to use HealthPopulate \n1. It should be updated to look at OperationalStatus, the doc probably needs some updates as well. \n2. We should move all resources to using it \n3. It probably makes sense that this be StatusPopulate / status.hpp and handles State as well as Health, HealthRollup.\n\nI kind of feel fixing up HealthPopulate is beyond this commit.",
      "parentUuid": "8743f0ba_56f9c77b",
      "range": {
        "startLine": 14,
        "startChar": 0,
        "endLine": 14,
        "endChar": 73
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7afc26ad_b9d97ae7",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-04-02T20:43:07Z",
      "side": 1,
      "message": "How does it handle other things?  Are we missing an interface?",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 55
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f0aa31af_896ea82f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 1000400
      },
      "writtenOn": "2021-04-06T10:05:33Z",
      "side": 1,
      "message": "Just like Gunnar said above.\nIn health.hpp, it use associations to determine health status(https://github.com/openbmc/bmcweb/blob/master/redfish-core/lib/health.hpp#L191). \nSo it need a daemon to create a new association path (such as :\n/xyz/openbmc_project/inventory/system/chassis/motherboard/powersupply0/critical). I saw the callback_manager in the initial commit of redfish_health_rollup.md on gerrit: https://gerrit.openbmc-project.xyz/c/openbmc/docs/+/21380/7/designs/redfish_health_rollup.md#76 . But it\u0027s Intel-specific, Other machines don\u0027t have daemon like this.\nSo the health.hpp can\u0027t handle this OperationalStatus.",
      "parentUuid": "7afc26ad_b9d97ae7",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 55
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cfcc351e_6562e315",
        "filename": "redfish-core/lib/processor.hpp",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-04-02T15:42:39Z",
      "side": 1,
      "message": "should the default be true ?\n    bool present \u003d true ;",
      "range": {
        "startLine": 53,
        "startChar": 19,
        "endLine": 53,
        "endChar": 24
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "56658ef6_c397c9cb",
        "filename": "redfish-core/lib/processor.hpp",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1000400
      },
      "writtenOn": "2021-04-06T10:05:33Z",
      "side": 1,
      "message": "Removed it",
      "parentUuid": "cfcc351e_6562e315",
      "range": {
        "startLine": 53,
        "startChar": 19,
        "endLine": 53,
        "endChar": 24
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "641e0be7_c9a714a2",
        "filename": "redfish-core/lib/processor.hpp",
        "patchSetId": 1
      },
      "lineNbr": 54,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-04-02T15:42:39Z",
      "side": 1,
      "message": "I think we should either \n\n1) Use these and line 153 - 169.\nE.g. \n    bool present \u003d true;\n    bool functional \u003d true;\n\n...\n\n      if (property.first \u003d\u003d \"Present\")\n      {\n          const bool* cpuPresent \u003d std::get_if\u003cbool\u003e(\u0026property.second);\n          if (cpuPresent \u003d\u003d nullptr)\n          {\n               // Important property not in desired type\n               messages::internalError(aResp-\u003eres);\n               return;\n           }\n     present \u003d *cpuPresent; \n      }\n\n\n...\n\n    if (present \u003d\u003d false)\n    {\n        aResp-\u003eres.jsonValue[\"Status\"][\"State\"] \u003d \"Absent\";\n        aResp-\u003eres.jsonValue[\"Status\"][\"Health\"] \u003d \"OK\";\n    }\n    else\n    {\n        aResp-\u003eres.jsonValue[\"Status\"][\"State\"] \u003d \"Enabled\";\n        if (functional)\n        {\n            aResp-\u003eres.jsonValue[\"Status\"][\"Health\"] \u003d \"OK\";\n        }\n        else\n        {\n            aResp-\u003eres.jsonValue[\"Status\"][\"Health\"] \u003d \"Critical\";\n        }\n    }\n\n\n2) Get rid of these and just set like you are in the else if \nE.g.\n  // Defaults \n  aResp-\u003eres.jsonValue[\"Status\"][\"State\"] \u003d \"Enabled\";\n  aResp-\u003eres.jsonValue[\"Status\"][\"Health\"] \u003d \"OK\";\n\n...\n\n            if (property.first \u003d\u003d \"Present\")\n            {\n                const bool* cpuPresent \u003d std::get_if\u003cbool\u003e(\u0026property.second);\n                if (cpuPresent \u003d\u003d nullptr)\n                {\n                    // Important property not in desired type\n                    messages::internalError(aResp-\u003eres);\n                    return;\n                }\n\n                if (*cpuPresent \u003d\u003d false)\n                {\n                    // Slot is not populated\n                    aResp-\u003eres.jsonValue[\"Status\"][\"State\"] \u003d \"Absent\";\n                 }\n           }\n            else if (property.first \u003d\u003d \"Functional\")\n            {\n                const bool* cpuFunctional \u003d std::get_if\u003cbool\u003e(\u0026property.second);\n                if (cpuFunctional !\u003d nullptr)\n                {\n                    if (*cpuFunctional \u003d\u003d false)\n                    {\n                        aResp-\u003eres.jsonValue[\"Status\"][\"Health\"] \u003d \"Critical\";\n\n                    }\n                }\n            }",
      "range": {
        "startLine": 53,
        "startChar": 0,
        "endLine": 54,
        "endChar": 27
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "37ad9c56_3ba5e211",
        "filename": "redfish-core/lib/processor.hpp",
        "patchSetId": 1
      },
      "lineNbr": 54,
      "author": {
        "id": 1000400
      },
      "writtenOn": "2021-04-06T10:05:33Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "641e0be7_c9a714a2",
      "range": {
        "startLine": 53,
        "startChar": 0,
        "endLine": 54,
        "endChar": 27
      },
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5a803e88_8fc9fc8d",
        "filename": "redfish-core/lib/processor.hpp",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-04-02T15:42:39Z",
      "side": 1,
      "message": "I don\u0027t think we should return here.",
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ac308956_4030e1b3",
        "filename": "redfish-core/lib/processor.hpp",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1000400
      },
      "writtenOn": "2021-04-06T10:05:33Z",
      "side": 1,
      "message": "Other attributes are not needed when the CPU isn\u0027t present. So I think we should return here.",
      "parentUuid": "5a803e88_8fc9fc8d",
      "revId": "3a0aed20db1f2fe96cc89488018702283a0e8248",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    }
  ]
}