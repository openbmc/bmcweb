{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "84a0f520_b5a2b591",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-07-12T03:50:20Z",
      "side": 1,
      "message": "Iâ€™m not understanding what the crash is.  yes, this is making a copy of a shared ptr instead of a reference.  why is that a problem?",
      "revId": "722d99dc952186a67d28e8acfa75246c8a0711c8",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "db9bcc49_996c5dfb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2024-07-15T01:45:07Z",
      "side": 1,
      "message": "I used gdb to debug this problem, but didn\u0027t get a clear answer, then I found the problem here through the code. Some info may help:\n\ncrash log:\nJul 27 16:57:48 sn123456 systemd[1]: Stopping bmcweb server...\nJul 27 16:57:50 sn123456 systemd[1]: bmcweb.service: Main process exited, code\u003ddumped, status\u003d11/SEGV\nJul 27 16:57:50sn123456 systemd[1]: bmcweb.service: Failed with result \u0027core-dump\u0027.\nJul 27 16:57:50 sn123456 systemd[1]: Stopped bmcweb server.\n\ngdb debug:\n(gdb) signal SIGTERM\nContinuing with signal SIGTERM.\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0073621c in boost::system::error_code::operator\u003d\u003cboost::asio::error::basic_errors\u003e(boost::asio::error::basic_errors) [clone .isra.0] (this\u003dthis@entry\u003d0x66647339, val\u003dval@entry\u003dboost::asio::error::operation_aborted)\n    at /usr/include/boost/system/detail/error_code.hpp:207\n207     /usr/include/boost/system/detail/error_code.hpp: No such file or directory.\n(gdb) bt\n#0  0x0073621c in boost::system::error_code::operator\u003d\u003cboost::asio::error::basic_errors\u003e(boost::asio::error::basic_errors) [clone .isra.0] (this\u003dthis@entry\u003d0x66647339, val\u003dval@entry\u003dboost::asio::error::operation_aborted)\n    at /usr/include/boost/system/detail/error_code.hpp:207\n#1  0x00682a34 in boost::asio::detail::epoll_reactor::deregister_descriptor (this\u003d0x146e4c8, descriptor\u003d\u003coptimized out\u003e, \n    descriptor_data\u003d@0x1470610: 0x146de78, closing\u003d\u003coptimized out\u003e)\n    at /usr/include/boost/asio/detail/impl/epoll_reactor.ipp:411\n#2  0x00659538 in boost::asio::detail::reactive_descriptor_service::release (impl\u003d..., this\u003d\u003coptimized out\u003e)\n    at /usr/include/boost/asio/detail/impl/reactive_descriptor_service.ipp:164\n#3  boost::asio::posix::basic_descriptor\u003cboost::asio::any_io_executor\u003e::release (this\u003d0x1470604)\n    at /usr/include/boost/asio/posix/basic_descriptor.hpp:381\n#4  sdbusplus::asio::connection::~connection (this\u003d\u003coptimized out\u003e, this\u003d\u003coptimized out\u003e)\n    at /usr/include/sdbusplus/asio/connection.hpp:72\n#5  std::destroy_at\u003csdbusplus::asio::connection\u003e (__location\u003d0x14705ec) at /usr/include/c++/12.2.0/bits/stl_construct.h:88\n#6  std::_Destroy\u003csdbusplus::asio::connection\u003e (__pointer\u003d0x14705ec) at /usr/include/c++/12.2.0/bits/stl_construct.h:149\n#7  std::allocator_traits\u003cstd::allocator\u003cvoid\u003e \u003e::destroy\u003csdbusplus::asio::connection\u003e (__p\u003d0x14705ec)\n    at /usr/include/c++/12.2.0/bits/alloc_traits.h:648\n#8  std::_Sp_counted_ptr_inplace\u003csdbusplus::asio::connection, std::allocator\u003cvoid\u003e, (__gnu_cxx::_Lock_policy)2\u003e::_M_dispose (\n    this\u003d0x14705e0) at /usr/include/c++/12.2.0/bits/shared_ptr_base.h:613\n#9  0x00447060 in std::_Sp_counted_base\u003c(__gnu_cxx::_Lock_policy)2\u003e::_M_release_last_use (this\u003d0x14705e0)\n    at /usr/include/c++/12.2.0/bits/shared_ptr_base.h:361\n#10 std::_Sp_counted_base\u003c(__gnu_cxx::_Lock_policy)2\u003e::_M_release (this\u003d0x14705e0)\n    at /usr/include/c++/12.2.0/bits/shared_ptr_base.h:361\n#11 0x005277f8 in std::__shared_count\u003c(__gnu_cxx::_Lock_policy)2\u003e::~__shared_count (this\u003d\u003coptimized out\u003e, \n    this\u003d\u003coptimized out\u003e) at /usr/include/c++/12.2.0/bits/shared_ptr_base.h:1071\n#12 0x00447060 in std::_Sp_counted_base\u003c(__gnu_cxx::_Lock_policy)2\u003e::_M_release_last_use (this\u003d0x147b308)\n    at /usr/include/c++/12.2.0/bits/shared_ptr_base.h:361\n#13 std::_Sp_counted_base\u003c(__gnu_cxx::_Lock_policy)2\u003e::_M_release (this\u003d0x147b308)\n    at /usr/include/c++/12.2.0/bits/shared_ptr_base.h:361\n#14 0x005277f8 in std::__shared_count\u003c(__gnu_cxx::_Lock_policy)2\u003e::~__shared_count (this\u003d\u003coptimized out\u003e, \n    this\u003d\u003coptimized out\u003e) at /usr/include/c++/12.2.0/bits/shared_ptr_base.h:1071\n#15 0x00527a00 in std::__shared_ptr\u003csdbusplus::asio::dbus_interface, (__gnu_cxx::_Lock_policy)2\u003e::~__shared_ptr (\n--Type \u003cRET\u003e for more, q to quit, c to continue without paging--c\n    this\u003d\u003coptimized out\u003e, this\u003d\u003coptimized out\u003e) at /usr/include/c++/12.2.0/bits/shared_ptr_base.h:1524\n#16 std::shared_ptr\u003csdbusplus::asio::dbus_interface\u003e::~shared_ptr (this\u003d\u003coptimized out\u003e, this\u003d\u003coptimized out\u003e) at /usr/include/c++/12.2.0/bits/shared_ptr.h:175\n#17 0x7674f330 in ?? () from target:/lib/libc.so.6\nBacktrace stopped: previous frame identical to this frame (corrupt stack?)",
      "parentUuid": "84a0f520_b5a2b591",
      "revId": "722d99dc952186a67d28e8acfa75246c8a0711c8",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a4d9a315_4c1a0afe",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-07-15T02:29:18Z",
      "side": 1,
      "message": "how do you reproduce it?",
      "parentUuid": "db9bcc49_996c5dfb",
      "revId": "722d99dc952186a67d28e8acfa75246c8a0711c8",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f1b31821_ed807a06",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2024-07-15T03:02:39Z",
      "side": 1,
      "message": "Go through the following steps:\n1. Use redfish to create multiple subscriptions (it seems that the more subscriptions, the higher the probability of crash)\ncurl -k -u user:passwd -X POST https://192.168.252.132/redfish/v1/EventService/Subscriptions/ -d \u0027\n{\n\"Context\": \"CustomText\",\n\"Destination\": \"https://30.221.33.11:5678\",\n\"Protocol\": \"Redfish\",\n\"EventFormatType\": \"Event\",\n\"DeliveryRetryPolicy\": \"RetryForever\",\n\"ResourceTypes\": [\n\"Task\"\n],\n\"HttpHeaders\": [\n{\n\"Authentication\": \"Splunk 49ce1-sdfoijf-wegsdfe-qwessddasd\"\n}\n]\n}\u0027\n2. Restart bmcweb\nsystemctl restart bmcweb.service",
      "parentUuid": "a4d9a315_4c1a0afe",
      "revId": "722d99dc952186a67d28e8acfa75246c8a0711c8",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "109729f9_6e1acf6d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-07-16T00:58:45Z",
      "side": 1,
      "message": "```\n#0  0x00704150 in boost::asio::detail::epoll_reactor::deregister_descriptor (this\u003d0x0, descriptor\u003d8,\n    descriptor_data\u003d@0x81dd08: 0xc223a8, closing\u003dfalse) at /usr/include/boost/asio/detail/impl/epoll_reactor.ipp:403\n403\t/usr/include/boost/asio/detail/impl/epoll_reactor.ipp: No such file or directory.\n(gdb)\n(gdb) where\n#0  0x00704150 in boost::asio::detail::epoll_reactor::deregister_descriptor (this\u003d0x0, descriptor\u003d8,\n    descriptor_data\u003d@0x81dd08: 0xc223a8, closing\u003dfalse) at /usr/include/boost/asio/detail/impl/epoll_reactor.ipp:403\n#1  0x0076b16c in boost::asio::detail::reactive_descriptor_service::destroy (impl\u003d..., this\u003d0xbfa440)\n    at /usr/include/boost/asio/detail/impl/reactive_descriptor_service.ipp:94\n#2  boost::asio::detail::io_object_impl\u003cboost::asio::detail::reactive_descriptor_service, boost::asio::any_io_executor\u003e::~io_object_impl() [clone .isra.0] (this\u003d\u003coptimized out\u003e, this\u003d\u003coptimized out\u003e) at /usr/include/boost/asio/detail/io_object_impl.hpp:95\n#3  0x005e431c in boost::asio::posix::basic_descriptor\u003cboost::asio::any_io_executor\u003e::~basic_descriptor (this\u003d\u003coptimized out\u003e,\n    this\u003d\u003coptimized out\u003e) at /usr/include/boost/asio/posix/basic_descriptor.hpp:718\n#4  boost::asio::posix::basic_stream_descriptor\u003cboost::asio::any_io_executor\u003e::~basic_stream_descriptor (this\u003d\u003coptimized out\u003e,\n    this\u003d\u003coptimized out\u003e) at /usr/include/boost/asio/posix/basic_stream_descriptor.hpp:49\n#5  std::_Optional_payload_base\u003cboost::asio::posix::basic_stream_descriptor\u003cboost::asio::any_io_executor\u003e \u003e::_M_destroy (\n    this\u003d0x81dcfc \u003c_ZN7redfishL11inotifyConnE.lto_priv.0\u003e) at /usr/include/c++/13.2.0/optional:287\n#6  std::_Optional_payload_base\u003cboost::asio::posix::basic_stream_descriptor\u003cboost::asio::any_io_executor\u003e \u003e::_M_reset (\n    this\u003d0x81dcfc \u003c_ZN7redfishL11inotifyConnE.lto_priv.0\u003e) at /usr/include/c++/13.2.0/optional:318\n#7  std::_Optional_payload\u003cboost::asio::posix::basic_stream_descriptor\u003cboost::asio::any_io_executor\u003e, false, false, false\u003e::~_Optional_payload (this\u003d\u003coptimized out\u003e, this\u003d\u003coptimized out\u003e) at /usr/include/c++/13.2.0/optional:439\n#8  std::_Optional_base\u003cboost::asio::posix::basic_stream_descriptor\u003cboost::asio::any_io_executor\u003e, false, false\u003e::~_Optional_base (this\u003d\u003coptimized out\u003e, this\u003d\u003coptimized out\u003e) at /usr/include/c++/13.2.0/optional:510\n#9  std::optional\u003cboost::asio::posix::basic_stream_descriptor\u003cboost::asio::any_io_executor\u003e \u003e::~optional (\n    this\u003d\u003coptimized out\u003e, this\u003d\u003coptimized out\u003e) at /usr/include/c++/13.2.0/optional:705\n#10 0x7663aa30 in __run_exit_handlers (status\u003d12556632, listp\u003d0x7663aa30 \u003c__run_exit_handlers+476\u003e,\n    run_list_atexit\u003drun_list_atexit@entry\u003dtrue, run_dtors\u003drun_dtors@entry\u003dtrue) at exit.c:108\n#11 0x7663abec in __GI_exit (status\u003d\u003coptimized out\u003e) at exit.c:138\n#12 0x76623434 in __libc_start_call_main (main\u003d0x76623434 \u003c__libc_start_call_main+112\u003e, main@entry\u003d0x38, argc\u003d1987448408,\n    argc@entry\u003d1987453688, argv\u003d0x5024d0 \u003cmain(int, char**)\u003e, argv@entry\u003d0x7e8c8e14)\n    at /usr/src/debug/glibc/2.39+git/sysdeps/nptl/libc_start_call_main.h:74\n#13 0x7662351c in __libc_start_main_impl (main\u003d0x38, argc\u003d1987453688, argv\u003d0x7e8c8e14, init\u003d\u003coptimized out\u003e, fini\u003d0x0,\n    rtld_fini\u003d0x76f08998 \u003c_dl_fini\u003e, stack_end\u003d0x7e8c8e14) at libc-start.c:360\n#14 0x00503bec in _start () at ../sysdeps/arm/start.S:105\n```\n\nThis is the result I get when I look at the coredump.\n\nWe should do your fix as well (please get it rewritten to just be the change to the reference), but I believe this is the underlying problem.\n\nhttps://gerrit.openbmc.org/c/openbmc/bmcweb/+/72784\n\nIf you could test that, I\u0027d appreciate it.",
      "parentUuid": "f1b31821_ed807a06",
      "revId": "722d99dc952186a67d28e8acfa75246c8a0711c8",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}