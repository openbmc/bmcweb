{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "5e4d030c_604a0d7b",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 374,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-09-17T20:52:18Z",
      "side": 1,
      "message": "Why are we checking explicitly against 200 for errors?  200 is used for HTTP requests, and we shouldn\u0027t be reusing those codes for that.  Arguably a handler could want to return 200 from a websocket route instead of upgrading, so if we\u0027re going to allow the concept of \"the bmc route rejected the upgrade\" we\u0027ll need some other flag.",
      "range": {
        "startLine": 374,
        "startChar": 0,
        "endLine": 374,
        "endChar": 49
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6a21864_713633b6",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 374,
      "author": {
        "id": 1000907
      },
      "writtenOn": "2021-09-17T21:05:30Z",
      "side": 1,
      "message": "As mentioned in the comment below, the default response of http::response is 200. \nThe reason this explicit check is done is because, if everything was smooth and upgradation was done, the response would contain 200, so since the upgradation is already done, we wouldn\u0027t need to reply through this connection. That\u0027s why calling the else section to destroy this connection.\nIncase of any errors, say like privilege check error, we would need to reply through the same connection without upgrading.\nSo, only unsuccessful messages needs to be communicated through this channel.\n\nEither ways, on success i.e. on upgrade, we wouldn\u0027t have this adaptor anymore to send the OK response.",
      "parentUuid": "5e4d030c_604a0d7b",
      "range": {
        "startLine": 374,
        "startChar": 0,
        "endLine": 374,
        "endChar": 49
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dafad917_ef53409a",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 374,
      "author": {
        "id": 1001099
      },
      "writtenOn": "2022-04-12T19:13:39Z",
      "side": 1,
      "message": "I think flags here will be 1000 and 1001?\nIf we like to post error info.\nright?\nhttps://github.com/Luka967/websocket-close-codes",
      "parentUuid": "e6a21864_713633b6",
      "range": {
        "startLine": 374,
        "startChar": 0,
        "endLine": 374,
        "endChar": 49
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b22b0327_22196fe7",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 374,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-04-12T20:15:41Z",
      "side": 1,
      "message": "\u003e upgradation was done, the response would contain 200\n\nTechnically if everything worked, we would expect to see a 101 Switching Protocols, right?  I think this is kind of the core of the problem, we\u0027re trying to inject behavior post-upgrade that needs to be done pre-upgrade.  Beast handles this already on line 106 of websocket.hpp.  If we need to expose that callback to each individual route, I suspect we need a separate callback from onopen(), because onopen happens after the websocket has been negotiated.",
      "parentUuid": "dafad917_ef53409a",
      "range": {
        "startLine": 374,
        "startChar": 0,
        "endLine": 374,
        "endChar": 49
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4daab081_0f23fe88",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 374,
      "author": {
        "id": 1001099
      },
      "writtenOn": "2022-04-16T21:58:31Z",
      "side": 1,
      "message": "this will respond 101 after upgred",
      "parentUuid": "b22b0327_22196fe7",
      "range": {
        "startLine": 374,
        "startChar": 0,
        "endLine": 374,
        "endChar": 49
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ce93ecd7_9444012a",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 382,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-09-17T20:52:18Z",
      "side": 1,
      "message": "Why do we need to post this?  can\u0027t we just call completeRequest directly?",
      "range": {
        "startLine": 382,
        "startChar": 20,
        "endLine": 382,
        "endChar": 37
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c2a59530_2d9b3cd2",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 382,
      "author": {
        "id": 1000907
      },
      "writtenOn": "2021-09-17T21:05:30Z",
      "side": 1,
      "message": "This is the current implementation as seen in line 361.",
      "parentUuid": "ce93ecd7_9444012a",
      "range": {
        "startLine": 382,
        "startChar": 20,
        "endLine": 382,
        "endChar": 37
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "49404719_2879d1a3",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 382,
      "author": {
        "id": 1001099
      },
      "writtenOn": "2022-04-12T19:13:39Z",
      "side": 1,
      "message": "Hello, Ed \nDo you mean we do not need to return any error info, only close the connection?",
      "parentUuid": "c2a59530_2d9b3cd2",
      "range": {
        "startLine": 382,
        "startChar": 20,
        "endLine": 382,
        "endChar": 37
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f069a069_43d4004a",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 382,
      "author": {
        "id": 1000907
      },
      "writtenOn": "2022-08-25T12:22:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "49404719_2879d1a3",
      "range": {
        "startLine": 382,
        "startChar": 20,
        "endLine": 382,
        "endChar": 37
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "66a82b35_7d8c8da8",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 385,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-09-17T20:52:18Z",
      "side": 1,
      "message": "Prefer to return early instead of calling else.",
      "range": {
        "startLine": 385,
        "startChar": 16,
        "endLine": 385,
        "endChar": 20
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1861d7a2_10da590a",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 385,
      "author": {
        "id": 1000907
      },
      "writtenOn": "2021-09-17T21:05:30Z",
      "side": 1,
      "message": "We cannot return here as the connection needs to be destroyed. For which CompleteRequestHAndler needs to be set to NULL.",
      "parentUuid": "66a82b35_7d8c8da8",
      "range": {
        "startLine": 385,
        "startChar": 16,
        "endLine": 385,
        "endChar": 20
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "74f975c1_6c134c23",
        "filename": "http/http_connection.hpp",
        "patchSetId": 1
      },
      "lineNbr": 385,
      "author": {
        "id": 1000276
      },
      "writtenOn": "2022-03-31T20:46:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1861d7a2_10da590a",
      "range": {
        "startLine": 385,
        "startChar": 16,
        "endLine": 385,
        "endChar": 20
      },
      "revId": "813cb23c020737b825c33a5ba25121b9a0f48130",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}