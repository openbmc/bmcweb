{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "aa55a1d4_42bf8362",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-02-27T00:13:44Z",
      "side": 1,
      "message": "Love to see progress here.  I\u0027m in full support of getting this done.",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8bc4bb02_0ca4f36b",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 47,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-02-27T00:13:44Z",
      "side": 1,
      "message": "Because this is security code, can we can a simple unit test or two for this?  Doesn\u0027t have to be extensive.",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cbbc536c_307d6047",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 47,
      "author": {
        "id": 1002382
      },
      "writtenOn": "2025-02-27T23:32:13Z",
      "side": 1,
      "message": "Got it! I have added the unit tests for `getCommonNameFromCert` and `getUPNFromCert` functions. Let me know if you have any feedback on the test",
      "parentUuid": "8bc4bb02_0ca4f36b",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "11b4b131_d674c61b",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 47,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-02-28T00:04:53Z",
      "side": 1,
      "message": "Thank you.",
      "parentUuid": "cbbc536c_307d6047",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0510a711_2b8e4464",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 55,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-02-27T00:13:44Z",
      "side": 1,
      "message": "nit, declare your variables where they\u0027re used.  Static analyzers complain if variables aren\u0027t initialized, so we tend to declare in the scope they\u0027re used.",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fa93e46a_bde52148",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 55,
      "author": {
        "id": 1002382
      },
      "writtenOn": "2025-02-27T23:32:13Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "0510a711_2b8e4464",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cfccad75_9ffa029e",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 73,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-02-27T00:13:44Z",
      "side": 1,
      "message": "Can this be split on a couple of lines with some intermediates for the params?  as-written it\u0027s a little rough to read.",
      "range": {
        "startLine": 70,
        "startChar": 0,
        "endLine": 73,
        "endChar": 79
      },
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a8697e1c_18d17f71",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 73,
      "author": {
        "id": 1002382
      },
      "writtenOn": "2025-02-27T23:32:13Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "cfccad75_9ffa029e",
      "range": {
        "startLine": 70,
        "startChar": 0,
        "endLine": 73,
        "endChar": 79
      },
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05dccb2e_608b99d9",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 106,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-02-27T00:13:44Z",
      "side": 1,
      "message": "This looks like it\u0027s going to return the UPN as-is?  getUsernameFromCert is expecting to return a username string local to this bmc.  I think some level of UPN parsing is required to verify:\n\nA. This bmc matches the hostname the UPN points to.\nB. Extract the username from the UPN string.",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "39f904ef_bb41b2b4",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 106,
      "author": {
        "id": 1001910
      },
      "writtenOn": "2025-02-27T15:35:22Z",
      "side": 1,
      "message": "Hi Ed, is there a spec dictating how an UPN should look like? AFAICT the UPN field can be free-form. The redfish spec mentions:\n\n\u003e This value shall indicate the service matches the User Principal Name (UPN) field in the provided certificate to the UserName property in a ManagerAccount resource or the appropriate field from an external account provider.\n\nIn our usage, we\u0027ve added the UPN field to match a local BMC username as an exact match (as we didn\u0027t want to introduce parsing logic that\u0027s specific to our org here)",
      "parentUuid": "05dccb2e_608b99d9",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "82f67624_3d4061a3",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 106,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-02-28T00:04:53Z",
      "side": 1,
      "message": "UPNs look like email addresses, so it would be something like\n\nmarco@this_bmc.facebook.com\n\nOr if you want to authorize a given cert against all BMCs (which seems like a bad idea from a security perspective, but you do you)\n\nmarco@facebook.com\n\nPresumably we need to strip of the portion that looks like an email.",
      "parentUuid": "39f904ef_bb41b2b4",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "27b91e97_ba715485",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 106,
      "author": {
        "id": 1002382
      },
      "writtenOn": "2025-03-03T22:43:38Z",
      "side": 1,
      "message": "Hi Ed, thanks for your comments! We have implemented the steps that you mentioned (matching the hostname-UPN and extract the username). Let us know if you have any concerns on this, thanks!",
      "parentUuid": "82f67624_3d4061a3",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "276f73f1_03cb2ad5",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 106,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-03-03T23:00:20Z",
      "side": 1,
      "message": "\u003e steps that you mentioned\n\nThis kind of statement worries me.  This shouldn\u0027t be an \"Ed told you to do it this way\" It should be in some kind of spec.  I highly recommend reaching out to DMTF (Where I\u0027m also present in the forums and on github) and see how this is intended to be implemented at a Redfish level and if they used any other specs for that.  I would ideally like to see that show up in your commit message, again, so we\u0027re not playing the \"Ed told us to do it this way\" game.  If we\u0027re making decisions beyond what the spec allows, that\u0027s when I can help you decide how OpenBMC should implement things where the spec gives backends freedom, but I don\u0027t believe the parsing of UPN is one of those things.",
      "parentUuid": "27b91e97_ba715485",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a9b65bec_daf1cde1",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 106,
      "author": {
        "id": 1002382
      },
      "writtenOn": "2025-03-04T15:05:06Z",
      "side": 1,
      "message": "Hi Ed, thanks for your feedbacks. I tried to search for official spec of the UPN format/parsing. The best sources that I can find are the official Microsoft website\n\nIt is stated that the UPN follows the RFC 822[1][2], which explain about the email format. The format is: someone@example.com (in the form of an email address) [3]. By convention, this should map to the user email name [1][2]. The UPN consists of 3 parts[4]:\n\n---\n| **Part**                                         | **Example**           |\n|--------------------------------------------------|-----------------------|\n| User account name. Also known as the logon name. | UserName              |\n| Separator. A character literal, the at sign (@). | @                     |\n| UPN suffix. Also known as the domain name.       | Example.Microsoft.com |\n---\n\nDomain name in the UPN identifies the domain in which the user account is located [3].\n\nBased on the explanation from the specs, I believe our implementation is aligned with the specifications. However, If you feel that this specification may not be entirely sufficient, please let us know. We would be more than happy to reach out to DMTF, to gather more information and ensure we are implementing it correctly\n\n---\n[1] UPN Attributes: https://learn.microsoft.com/en-us/windows/win32/adschema/a-userprincipalname\n[2] UPN Properties: https://learn.microsoft.com/en-us/windows/win32/ad/naming-properties#userprincipalname\n[3] UPN Glossary: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-wcce/719b890d-62e6-4322-b9b1-1f34d11535b4#gt_9d606f55-b798-4def-bf96-97b878bb92c6\n[4] UPN Format: https://learn.microsoft.com/en-us/windows/win32/secauthn/user-name-formats#user-principal-name",
      "parentUuid": "276f73f1_03cb2ad5",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ada15292_75b743d0",
        "filename": "http/mutual_tls.cpp",
        "patchSetId": 6
      },
      "lineNbr": 106,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-03-04T16:36:33Z",
      "side": 1,
      "message": "All of this is great information, and should be in some combination of your code comments and/or commit message.",
      "parentUuid": "a9b65bec_daf1cde1",
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e29155ad_bfdb9996",
        "filename": "include/sessions.hpp",
        "patchSetId": 6
      },
      "lineNbr": 250,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-02-27T00:13:44Z",
      "side": 1,
      "message": "We should really make this not a magic number, but oh well.... problem for another day.",
      "range": {
        "startLine": 250,
        "startChar": 37,
        "endLine": 250,
        "endChar": 38
      },
      "revId": "483d158ee4868a6501619115642a5e2c1eedbb10",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}