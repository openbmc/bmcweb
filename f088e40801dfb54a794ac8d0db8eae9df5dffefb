{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "df7342d5_478acf7f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 11,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-06-17T23:50:11Z",
      "side": 1,
      "message": "Just to be clear, we don\u0027t really need to do this anymore, right?  the only thing we needed to do was https://gerrit.openbmc.org/c/openbmc/bmcweb/+/72150/2?usp\u003drelated-change",
      "revId": "f088e40801dfb54a794ac8d0db8eae9df5dffefb",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "10ab68af_c528a219",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 11,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-06-17T23:50:55Z",
      "side": 1,
      "message": "That\u0027s not to say we shouldn\u0027t still remove it;  just that I don\u0027t think it blocks your other change.",
      "parentUuid": "df7342d5_478acf7f",
      "revId": "f088e40801dfb54a794ac8d0db8eae9df5dffefb",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3f6bfc34_e306f9fe",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 11,
      "author": {
        "id": 1001758
      },
      "writtenOn": "2024-06-18T00:27:21Z",
      "side": 1,
      "message": "This is an insecure method for image download via tftp which was only enabled by IBM using insecure-tftp-update feature flag. I checked with @Andrew and they don\u0027t use this feature anymore https://discord.com/channels/775381525260664832/855566794994221117/1250430728945143878 and has been removed via https://gerrit.openbmc.org/c/openbmc/openbmc/+/72053.\nSince, there is no active user of tftp based updates upstream, it seems better to retire this flow rather than adding support for new DBus interface. In future, we can add support for HTTP based downloads as a new feature (not supported at the moment).",
      "parentUuid": "10ab68af_c528a219",
      "revId": "f088e40801dfb54a794ac8d0db8eae9df5dffefb",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "021e1017_f09fdb20",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 11,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-06-25T18:20:43Z",
      "side": 1,
      "message": "\u003e retire this flow\n\nHTTP/HTTPS pull updates would follow the same flow though?  If we completely retire it, how would we support those in the future (Which as you can see from the patch history i\u0027ve been working on).\n\nI was intending to follow the same flow as TFTP, but if your goal is to remove TFTP entirely, how would you suggest implementing it instead?",
      "parentUuid": "3f6bfc34_e306f9fe",
      "revId": "f088e40801dfb54a794ac8d0db8eae9df5dffefb",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b1c0dcc0_bb15c050",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 11,
      "author": {
        "id": 1001758
      },
      "writtenOn": "2024-06-25T23:18:39Z",
      "side": 1,
      "message": "With StartUpdate D-Bus API i don\u0027t think we can use the current flow as current flow goes through multiple apps - BMCWeb -\u003e downloadManager -\u003e CodeUpdater. The idea was to deprecate the tftp path since no one uses it and then brainstorm how we should implement this for HTTP flow using D-Bus interface.\n\nThe current distributed flow works because only one update at a time and that too only BMC update is supported, so task handler knows which activation interface to watch for on D-Bus.\n\nIn general, the main actions for HTTP flow can be -\n1. Create Task and return to user.\n2. Asynchronously download the Image.\n3. Invoke the StartUpdate action with imageFd to CodeUpdater.\n4. Watch for activation status changes and update task status.\n\nMy understanding is these need to happen in a way so BMCWeb can co-relate the task to the backend to watch for (since BMCWeb is the one to call startUpdate). The critical piece is image download after which we can trigger an update request to CodeUpdater and before which we need to return back to client with TaskInfo.\n\nSo, this will probably involve some discussion on how to handle this.",
      "parentUuid": "021e1017_f09fdb20",
      "revId": "f088e40801dfb54a794ac8d0db8eae9df5dffefb",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "377e0504_7ef44c7d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 11,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-06-28T00:05:07Z",
      "side": 1,
      "message": "\u003e With StartUpdate D-Bus API i don\u0027t think we can use the current flow as current flow goes through multiple apps - BMCWeb -\u003e downloadManager -\u003e CodeUpdater. The idea was to deprecate the tftp path since no one uses it and then brainstorm how we should implement this for HTTP flow using D-Bus interface.\n\u003e \n\u003e The current distributed flow works because only one update at a time and that too only BMC update is supported, so task handler knows which activation interface to watch for on D-Bus.\n\u003e \n\u003e In general, the main actions for HTTP flow can be -\n\u003e 1. Create Task and return to user.\n\u003e 2. Asynchronously download the Image.\n\u003e 3. Invoke the StartUpdate action with imageFd to CodeUpdater.\n\u003e 4. Watch for activation status changes and update task status.\n\u003e \n\u003e My understanding is these need to happen in a way so BMCWeb can co-relate the task to the backend to watch for (since BMCWeb is the one to call startUpdate). The critical piece is image download after which we can trigger an update request to CodeUpdater and before which we need to return back to client with TaskInfo.\n\u003e \n\u003e So, this will probably involve some discussion on how to handle this.\n\nRight, my assumption was that the existing TFTP flows already do steps 1-4.  If you\u0027d prefer to talk about this in a different forum (not this patch) I\u0027m happy to do talk about it there, but I\u0027d just like to understand the path for an http pull feature in the new model.",
      "parentUuid": "b1c0dcc0_bb15c050",
      "revId": "f088e40801dfb54a794ac8d0db8eae9df5dffefb",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8de0ca43_4dc70083",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 11,
      "author": {
        "id": 1001758
      },
      "writtenOn": "2024-07-01T23:17:53Z",
      "side": 1,
      "message": "Sure, i have created a BMCWeb issue to discuss on this topic https://github.com/openbmc/bmcweb/issues/281 and added more details.\n\nPlease let me know if you are fine with merging this change?",
      "parentUuid": "377e0504_7ef44c7d",
      "revId": "f088e40801dfb54a794ac8d0db8eae9df5dffefb",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "42ffd8e5_95eb2985",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 11,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-07-01T23:56:28Z",
      "side": 1,
      "message": "\u003e Please let me know if you are fine with merging this change?\n\nOnce we have an understanding of how general push updates fit in this new architecture.  Previously they were going to follow the TFTP model, so I don\u0027t want to remove the TFTP model until there\u0027s an understanding of how the new model handles the same task.",
      "parentUuid": "8de0ca43_4dc70083",
      "revId": "f088e40801dfb54a794ac8d0db8eae9df5dffefb",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}