{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c987088c_ed491f04",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 27
      },
      "lineNbr": 0,
      "author": {
        "id": 1000350
      },
      "writtenOn": "2025-04-18T17:37:48Z",
      "side": 1,
      "message": "Hi Ed\n\nThis patch is useful for testing aggregation and allows aggregation topology configurable via redfish interfaces\n\ncurl -vvvv -k --http1.1 -H \"X-Auth-Token: $bmc_token\" https://${bmc}/redfish/v1/AggregationService/AggregationSources -H \"Content-Type: application/json\" --request POST --data \u0027{\"HostName\":\"https://9.5.5.122:443\"}\u0027\n{\n \"@Message.ExtendedInfo\": [\n  {\n   \"@odata.type\": \"#Message.v1_1_1.Message\",\n   \"Message\": \"The resource was created successfully.\",\n   \"MessageArgs\": [],\n   \"MessageId\": \"Base.1.19.Created\",\n   \"MessageSeverity\": \"OK\",\n   \"Resolution\": \"None.\"\n  }\n ]\n\ncurl k -H \"X-Auth-Token: $bmc_token\" -X GET https://${bmc}/redfish/v1/AggregationService/AggregationSources\n{\n \"@odata.id\": \"/redfish/v1/AggregationService/AggregationSources\",\n \"@odata.type\": \"#AggregationSourceCollection.AggregationSourceCollection\",\n \"Members\": [\n  {\n   \"@odata.id\": \"/redfish/v1/AggregationService/AggregationSources/21BQ6Q1o\"\n  }\n ],\n \"Members@odata.count\": 1,\n \"Name\": \"Aggregation Source Collection\"\n}\n\ncurl -k -H \"X-Auth-Token: $bmc_token\" -X GET https://${bmc}/redfish/v1/AggregationService/AggregationSources/21BQ6Q1o\n{\n \"@odata.id\": \"/redfish/v1/AggregationService/AggregationSources/21BQ6Q1o\",\n \"@odata.type\": \"#AggregationSource.v1_3_1.AggregationSource\",\n \"HostName\": \"https://9.5.5.122:443\",\n \"Id\": \"21BQ6Q1o\",\n \"Name\": \"Aggregation source\",\n \"Password\": null\n}\n\nWhen I configure IP or hostname which is not accessible or not resolved then I see redfish/v1 output hangs for sometime..\n\npr 18 17:23:48 p10bmc bmcweb[1099]: [ERROR async_resolve.hpp:92] Resolve failed: Connection timed out\nApr 18 17:23:48 p10bmc bmcweb[1099]: [ERROR http_client.hpp:179] Resolve failed: Connection timed out https://9.5.5.122:80/redfish/v1/AggregationService/AggregationSources\n\n\nThis commit will be really useful for testing aggregation, Thank you for this commit.",
      "revId": "51c0cdaffac8b5d738f62185d0a49db45b1aca5c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2e373b8e_d2e5f100",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 27
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-04-18T19:33:16Z",
      "side": 1,
      "message": "Now that other folks find this useful, I intend to merge this.\n\nleaving in review a little longer to give folks time to object.",
      "revId": "51c0cdaffac8b5d738f62185d0a49db45b1aca5c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "192493c8_8752499c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 27
      },
      "lineNbr": 0,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2025-04-21T22:10:32Z",
      "side": 1,
      "message": "\u003e When I configure IP or hostname which is not accessible or not resolved then I see redfish/v1 output hangs for sometime..\n\u003e \n\u003e pr 18 17:23:48 p10bmc bmcweb[1099]: [ERROR async_resolve.hpp:92] Resolve failed: Connection timed out\n\u003e Apr 18 17:23:48 p10bmc bmcweb[1099]: [ERROR http_client.hpp:179] Resolve failed: Connection timed out https://9.5.5.122:80/redfish/v1/AggregationService/AggregationSources\n\nAdding clarification in case others may think this is a bug.  `/redfish/v1` requires querying any satellite BMCs in case we need to add links to resource collection which do not appear on the aggregating BMC but do appear on a satellite BMC.\n\nThe timeout is thus because the aggregator has to timeout while waiting for a response from a BMC that does not exist.",
      "parentUuid": "c987088c_ed491f04",
      "revId": "51c0cdaffac8b5d738f62185d0a49db45b1aca5c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6b5c827e_48a13956",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 27
      },
      "lineNbr": 460,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2025-04-21T22:10:32Z",
      "side": 1,
      "message": "We\u0027ll hit a failure if we try to add a satellite HMC through POST when one already exists on dbus.  Same for adding multiple satellites through POST.\n\nShould we add handling to prevent these cases in the POST handler or add a check in the aggregator to avoid searching dbus (and hitting this check) if the `currentAggregationSources` unordered_map is not empty?",
      "range": {
        "startLine": 453,
        "startChar": 20,
        "endLine": 460,
        "endChar": 21
      },
      "revId": "51c0cdaffac8b5d738f62185d0a49db45b1aca5c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "78c50399_ac195cbd",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 27
      },
      "lineNbr": 460,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-04-21T22:17:55Z",
      "side": 1,
      "message": "\u003e We\u0027ll hit a failure if we try to add a satellite HMC through POST when one already exists on dbus.  Same for adding multiple satellites through POST.\n\u003e \n\u003e Should we add handling to prevent these cases in the POST handler or add a check in the aggregator to avoid searching dbus (and hitting this check) if the `currentAggregationSources` unordered_map is not empty?\n\n\nFor the moment that\u0027s intentional, because we only have one prefix defined, so even if this condition wasn\u0027t present, we\u0027d still fail later on.  We still only support one aggregation source at a time, although it\u0027d be great to fix that, I\u0027d rather keep this specific patch as \"only supports one satmc\" and work on supporting multiples in a future patch.  Seem ok?",
      "parentUuid": "6b5c827e_48a13956",
      "range": {
        "startLine": 453,
        "startChar": 20,
        "endLine": 460,
        "endChar": 21
      },
      "revId": "51c0cdaffac8b5d738f62185d0a49db45b1aca5c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e3d9c121_7088c2af",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 27
      },
      "lineNbr": 1306,
      "author": {
        "id": 1001303
      },
      "writtenOn": "2025-04-21T22:10:32Z",
      "side": 1,
      "message": "This will need to be updated since the satellites added via POST will get randomized prefixes.",
      "range": {
        "startLine": 1306,
        "startChar": 16,
        "endLine": 1306,
        "endChar": 58
      },
      "revId": "51c0cdaffac8b5d738f62185d0a49db45b1aca5c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ffd84976_c4d2fe22",
        "filename": "redfish-core/include/redfish_aggregator.hpp",
        "patchSetId": 27
      },
      "lineNbr": 1306,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2025-04-21T22:17:55Z",
      "side": 1,
      "message": "Yep..... it will if we support more than one sat at a time.  Pretty sure for a single sat it\u0027s correct?",
      "parentUuid": "e3d9c121_7088c2af",
      "range": {
        "startLine": 1306,
        "startChar": 16,
        "endLine": 1306,
        "endChar": 58
      },
      "revId": "51c0cdaffac8b5d738f62185d0a49db45b1aca5c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}