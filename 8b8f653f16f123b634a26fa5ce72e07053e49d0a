{
  "comments": [
    {
      "key": {
        "uuid": "5b8f7b3a_35f55b9e",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1376,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-08-03T17:45:17Z",
      "side": 1,
      "message": "This looks wrong, GetSubTree will return an error code if the object isn\u0027t found.  This is an instance of common error #11.",
      "range": {
        "startLine": 1376,
        "startChar": 0,
        "endLine": 1376,
        "endChar": 52
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "65637a8f_9fe3a34d",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1376,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-08-03T18:48:28Z",
      "side": 1,
      "message": "I used to think the same thing, but I think if GetSubTree doesn\u0027t find the object it just returns an empty array. I\u0027m going to let Ali test and tell us for sure. ;) \n\ndbus-send --system --print-reply --dest\u003dxyz.openbmc_project.ObjectMapper /xyz/openbmc_project/object_mapper xyz.openbmc_project.ObjectMapper.GetSubTree string:\"/\" int32:0 array:string:\"garbage.item.inventory\"\nmethod return time\u003d1628015868.551455 sender\u003d:1.72 -\u003e destination\u003d:1.147 serial\u003d2180 reply_serial\u003d2\n   array [\n   ]",
      "parentUuid": "5b8f7b3a_35f55b9e",
      "range": {
        "startLine": 1376,
        "startChar": 0,
        "endLine": 1376,
        "endChar": 52
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c87c60d1_a3fd19c9",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1376,
      "author": {
        "id": 1001083
      },
      "writtenOn": "2021-08-10T03:59:34Z",
      "side": 1,
      "message": "In my testing, GetSubTree does return an empty array if there is input interfaces are incorrect. My output is the same as Gunnar\u0027s above.\n\nAdditionally, I receive a resourceNotFound error from getSubTree if the input root is incorrect.\n\ndbus-send --system --print-reply --dest\u003dxyz.openbmc_project.ObjectMapper /xyz/openbmc_project/object_mapper xyz.openbmc_project.ObjectMapper.GetSubTree string:\"/abc/\" int32:0 array:string:\"xyz.bopenbmc_project.Control.TPM.Policy\"\n\nError xyz.openbmc_project.Common.Error.ResourceNotFound: path or object not found",
      "parentUuid": "65637a8f_9fe3a34d",
      "range": {
        "startLine": 1376,
        "startChar": 0,
        "endLine": 1376,
        "endChar": 52
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6c6e465c_9e250574",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1376,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-08-12T22:54:43Z",
      "side": 1,
      "message": "\u003e In my testing, GetSubTree does return an empty array if there is input interfaces are incorrect. My output is the same as Gunnar\u0027s above.\n\n\n\u003e \n\u003e Additionally, I receive a resourceNotFound error from getSubTree if the input root is incorrect.\n\n\nYou say that your results are the same as gunnars, then you link results below that show that they\u0027re different.  FWIW, I would\u0027ve expected what you saw, but it\u0027s odd we\u0027re getting different behavior here.\n\n\u003e \n\u003e dbus-send --system --print-reply --dest\u003dxyz.openbmc_project.ObjectMapper /xyz/openbmc_project/object_mapper xyz.openbmc_project.ObjectMapper.GetSubTree string:\"/abc/\" int32:0 array:string:\"xyz.bopenbmc_project.Control.TPM.Policy\"\n\u003e \n\u003e Error xyz.openbmc_project.Common.Error.ResourceNotFound: path or object not found\n\nThis is not an empty array.\n\n\n\n\n\nOk, I\u0027m not understanding here.  When I run Gunnars test, I get an empty array, when I run your test, I get the Not Found error.  what I suspect is when the object path exists, but doesn\u0027t have matching interfaces (as it does in gunnars test) the mapper returns an empty array.\n\nWhen the object path doesn\u0027t exist, it returns an error.  I think because we can\u0027t assume that any give path exists, we have to handle the error here?  It would be really nice if we could just make the mapper consistent again.",
      "parentUuid": "c87c60d1_a3fd19c9",
      "range": {
        "startLine": 1376,
        "startChar": 0,
        "endLine": 1376,
        "endChar": 52
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "789f5478_bd3f3844",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1376,
      "author": {
        "id": 1001083
      },
      "writtenOn": "2021-08-12T23:04:51Z",
      "side": 1,
      "message": "I\u0027m sorry I should have made it more clear.\n\nThe difference between Gunnar and I tests is that I changed the \u0027subtree\u0027 parameter to \u0027GetSubTree\u0027, i.e the first input parameter. I changed it from \"/\" to \"/abc/\", the latter of which is bogus and caused such an error.\n\nIn Gunnar\u0027s code, he changed only the 3rd input parameter of GetSubTree, interfaces. He changed it away from a valid interface (\"xyz.openbmc_project.Control.TPM.Policy\") to something bogus (\"\"garbage.item.inventory\").\n\nFrom https://github.com/openbmc/docs/blob/master/architecture/object-mapper.md:\n\nGetSubTree\n\nUse this method to find the objects, services, and interfaces in the specified subtree that implement a certain interface. If no interfaces are passed in, then all objects/services/interfaces in the subtree are returned. If interfaces are passed in, then only those interfaces are returned in the output.\n\nInputs:\n\nparam: subtree - the root of the tree. Using \"/\" will search the whole tree\nparam: depth - the maximum depth of the tree past the root to search. Use 0 to search all\nparam: interfaces - an optional list of interfaces to constrain the search to",
      "parentUuid": "6c6e465c_9e250574",
      "range": {
        "startLine": 1376,
        "startChar": 0,
        "endLine": 1376,
        "endChar": 52
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "56fa82ba_f9b3eb19",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1382,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-08-03T17:41:08Z",
      "side": 1,
      "message": "Not sure this comment makes complete since..\n// If interface is not found, set error and return",
      "range": {
        "startLine": 1381,
        "startChar": 0,
        "endLine": 1382,
        "endChar": 48
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9200d2f8_4bc8fbcd",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1382,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-08-03T17:45:17Z",
      "side": 1,
      "message": "Just remove the comment, it\u0027s clear what\u0027s happening from the code.",
      "parentUuid": "56fa82ba_f9b3eb19",
      "range": {
        "startLine": 1381,
        "startChar": 0,
        "endLine": 1382,
        "endChar": 48
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c104324e_423ba275",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1382,
      "author": {
        "id": 1001083
      },
      "writtenOn": "2021-08-10T03:59:34Z",
      "side": 1,
      "message": "This check handles Common Error #11 that was alluded at line 1376. If GetSubTree fails to find the anything for the \"xyz.openbmc_project.Control.TPM.Policy\", it returns an array of size 0 and the resourceNotFound error is caught here.",
      "parentUuid": "9200d2f8_4bc8fbcd",
      "range": {
        "startLine": 1381,
        "startChar": 0,
        "endLine": 1382,
        "endChar": 48
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2b345711_7ce2126e",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1384,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-08-03T17:41:08Z",
      "side": 1,
      "message": "This should really be \"TrustedModuleRequiredToBoot\"",
      "range": {
        "startLine": 1384,
        "startChar": 44,
        "endLine": 1384,
        "endChar": 54
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "29ed3098_a59d9149",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1384,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-08-03T17:45:17Z",
      "side": 1,
      "message": "This shouldn\u0027t even be resource not found.  the resource might be there, but doesn\u0027t support this parameter.  This is going to be a fun one to get the error codes right on.",
      "parentUuid": "2b345711_7ce2126e",
      "range": {
        "startLine": 1384,
        "startChar": 44,
        "endLine": 1384,
        "endChar": 54
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ff8d292f_aaff4307",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1384,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-08-03T18:48:28Z",
      "side": 1,
      "message": "I don\u0027t see a better error message. \nRedfish has a \"ActionNotSupported\": { but no \"PropertyNotSupport\". \n\nresourceNotFound is what we do other places, e.g. https://github.com/openbmc/bmcweb/blob/master/redfish-core/lib/systems.hpp#L2177 \n\nI can open an issue with Redfish for \"PropertyNotSupport\" if you agree that makes sense here.",
      "parentUuid": "29ed3098_a59d9149",
      "range": {
        "startLine": 1384,
        "startChar": 44,
        "endLine": 1384,
        "endChar": 54
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0184a534_43842599",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1384,
      "author": {
        "id": 1001083
      },
      "writtenOn": "2021-08-10T03:59:34Z",
      "side": 1,
      "message": "\"the resource might be there, but doesn\u0027t support this parameter.\"\nCan I ask what does this mean? \n\nIs maybe the proper place to catch a \u0027PropertyNotSupported\u0027 would be at the inner async_method_call at 1419 that attempts to access the dbus \u0027xyz.openbmc_project.Control.TPM.Policy\u0027 \u0027TPMEnable\u0027 property? \n\nIf it fails to support the parameter, is it possible to just leave TPMEnable in the \u0027Disabled\u0027 state?\n\n(This assumes \u0027PropertyNotSupported\u0027 is added to error_messages and is the correct error for this case.)",
      "parentUuid": "ff8d292f_aaff4307",
      "range": {
        "startLine": 1384,
        "startChar": 44,
        "endLine": 1384,
        "endChar": 54
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6d3e7ec6_4c310408",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1384,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-08-11T18:07:14Z",
      "side": 1,
      "message": "I think we should drive PropertyNotSupported with Redfish (if Ed is in agreement, I\u0027ll open an issue with them), I don\u0027t see a better error message now. \nI think Redfish would call this a Property since I don\u0027t see parameter used expert for Action Parameter or Query Parameter in the messages. \nhttps://redfish.dmtf.org/registries/Base.1.10.0.json",
      "parentUuid": "0184a534_43842599",
      "range": {
        "startLine": 1384,
        "startChar": 44,
        "endLine": 1384,
        "endChar": 54
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e0676a9b_28616024",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1384,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-08-12T22:54:43Z",
      "side": 1,
      "message": "In other places we\u0027ve used PropertyValueNotInList to defer when a given property was not supported on a given resource.\n\nIn this case, it could also be PropertyNotWritable, because we\u0027re talking about an optional interface here?",
      "parentUuid": "6d3e7ec6_4c310408",
      "range": {
        "startLine": 1384,
        "startChar": 44,
        "endLine": 1384,
        "endChar": 54
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a66ef42_e50af7c2",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1438,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2021-08-03T17:45:17Z",
      "side": 1,
      "message": "This needs combined with the existing GetSubTree method calls instead of duplicating the code here.",
      "range": {
        "startLine": 1435,
        "startChar": 0,
        "endLine": 1438,
        "endChar": 78
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0f26fd13_ce84a7a7",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1438,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2021-08-03T18:48:28Z",
      "side": 1,
      "message": "This code is based on PowerModes which has a GetSubTree for both GET and PATCH.\nhttps://github.com/openbmc/bmcweb/blob/master/redfish-core/lib/systems.hpp#L2224\nCan you explain more what you are thinking here?",
      "parentUuid": "8a66ef42_e50af7c2",
      "range": {
        "startLine": 1435,
        "startChar": 0,
        "endLine": 1438,
        "endChar": 78
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "77150cf5_82b94b6f",
        "filename": "redfish-core/lib/systems.hpp",
        "patchSetId": 9
      },
      "lineNbr": 1438,
      "author": {
        "id": 1001083
      },
      "writtenOn": "2021-08-10T03:59:34Z",
      "side": 1,
      "message": "I\u0027m sorry. I thought the proper method to access dbus service and objectPath objects was to use ObjectMapper?\n\nAre we trying to move GetSubTree calls to the BMCWEB_ROUTES and pass variables down to set and get functions? Something like this https://github.com/openbmc/bmcweb/blob/885bbf1c82ea9f9cbfbe0065ee46adc8e398c868/redfish-core/lib/processor.hpp#L1130?",
      "parentUuid": "0f26fd13_ce84a7a7",
      "range": {
        "startLine": 1435,
        "startChar": 0,
        "endLine": 1438,
        "endChar": 78
      },
      "revId": "8b8f653f16f123b634a26fa5ce72e07053e49d0a",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    }
  ]
}