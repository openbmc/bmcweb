{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "94105d09_eed8feb3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-04-25T20:38:53Z",
      "side": 1,
      "message": "Ravi, can you take another look at this?",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b6b10533_c966c1b0",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 1181,
      "author": {
        "id": 1000350
      },
      "writtenOn": "2024-04-26T17:02:46Z",
      "side": 1,
      "message": "I think certs/authority object path meant for CA certificates right?\nldap client certificate place at object path\n/xyz/openbmc_project/certs/client/ldap\nsimilarly certificate-manager may need to host these client certificates at similar path \n/xyz/openbmc_project/certs/client/\u003c\u003e",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45797df9_4c49ac43",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 1181,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-04-26T17:58:07Z",
      "side": 1,
      "message": "\u003e I think certs/authority object path meant for CA certificates right?\n\nThat\u0027s not what\u0027s in the existing code in Manager, and this code does seem to work.\n\n\u003e ldap client certificate place at object path\n\u003e /xyz/openbmc_project/certs/client/ldap\n\u003e similarly certificate-manager may need to host these client certificates at similar path \n\u003e /xyz/openbmc_project/certs/client/\u003c\u003e\n\nNothing changes about this compared to TrustStore, which uses the existing paths.  If we wanted to change those, we could, but that IMO isn\u0027t what this patch is trying to do.  It\u0027s trying to bring up ClientCertificates, using the existing flow that already exists.",
      "parentUuid": "b6b10533_c966c1b0",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4a686b0c_d5c91df9",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 1181,
      "author": {
        "id": 1000350
      },
      "writtenOn": "2024-04-26T18:27:32Z",
      "side": 1,
      "message": "Yes i understand, but if we look at certificate-manager design CA authority certificate and client certificate handled differently.\n\nhttps://github.com/openbmc/phosphor-dbus-interfaces/tree/master/yaml/xyz/openbmc_project/Certs#signed-certificate-upload-design-flowpre-generated\n\nas per certificate-manager design\n\"The URI /xyz/openbmc_project/certs/authority/truststore maps to instance of the certificate application handling Certificate Authority certificates\"\nso I was thinking these MFA client certificates needs to be handled differently than CA certificates in certificate-manager otherwise this commit looks good.",
      "parentUuid": "45797df9_4c49ac43",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e89e0bdd_93cc0615",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 1181,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-04-26T19:52:14Z",
      "side": 1,
      "message": "\u003e \"The URI /xyz/openbmc_project/certs/authority/truststore maps to instance of the certificate application handling Certificate Authority certificates\"\n\n\nIsn\u0027t that what this property is?  It\u0027s the list of certificates used for client authentication (ie the certificate authority).",
      "parentUuid": "4a686b0c_d5c91df9",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05e9278a_44f2b785",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 1181,
      "author": {
        "id": 1000350
      },
      "writtenOn": "2024-04-27T17:16:58Z",
      "side": 1,
      "message": "As per my understanding there two categories, CA root certificates and client certificates.\nif we are hosting these certs at \"/xyz/openbmc_project/certs/authority/truststore\" is there any way to know which is CA certificate or client certificates?\nsuppose if we configure both LDAP certificates  and MFA client certificates \nthere should be way to differentiate",
      "parentUuid": "e89e0bdd_93cc0615",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "78beba24_c95a0d5c",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 1181,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-04-27T17:26:20Z",
      "side": 1,
      "message": "\u003e As per my understanding there two categories, CA root certificates and client certificates.\n\u003e if we are hosting these certs at \"/xyz/openbmc_project/certs/authority/truststore\" is there any way to know which is CA certificate or client certificates?\n\u003e suppose if we configure both LDAP certificates  and MFA client certificates \n\u003e there should be way to differentiate\n\nThey\u0027re all root certificates.  If phosphor-certificate-manager wanted to, it could have methods for getting certificates by an ext property, which would allow us to filter down further, but this doesn\u0027t seem terribly useful.  It seems relatively unlikely that a user is going to set up both LDAP and mutual TLS, so in practice we\u0027d likely have one root certificate, and this issue wouldn\u0027t pop up.\n\nFWIW, I\u0027m open to looking into changes into that area, but I think the development order should go:\n1. Implement ClientCertificateCollection GET, using existing certificate methods.\n2. Implement ClientCertificateCollection POST, using existing certificate methods.\n(at this point, the base use cases work, and we can test compliance).\n3. Implement support in phosphor-certificate-manager for filtering client certificates.\n4. Move bmcweb over to the new certificate filtering API (which should be a simple change).\n\nSeem reasonable?",
      "parentUuid": "05e9278a_44f2b785",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "50cec41c_0f313b8a",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 1217,
      "author": {
        "id": 1000350
      },
      "writtenOn": "2024-04-26T17:53:03Z",
      "side": 1,
      "message": "same here, I think hosting client certificates at \"xyz.openbmc_project.Certs.Manager.Authority.Truststore\" does not look right.\nas per my understanding authority D-bus meant for CA certificates management",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "40932621_da2edb14",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 1217,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-04-26T17:58:34Z",
      "side": 1,
      "message": "It\u0027s what\u0027s already used currently, so I\u0027m not sure what more we can do.",
      "parentUuid": "50cec41c_0f313b8a",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9ca67aea_2abd1780",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 2116,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2024-04-26T20:18:49Z",
      "side": 1,
      "message": "Doesn\u0027t /redfish/v1/AccountService/MultiFactorAuth also need to be implemented?\n\nSomething doesn\u0027t add up here or my understanding of Redfish is off. \nI thought all segments in a path should map to a schema. \nSo you could go to a Redfish Route and walk backwards to /redfish/v1/\nE.g.\n/redfish/v1/Systems/system/LogServices/EventLog/Entries/141 \u003c- LogEntry \n/redfish/v1/Systems/system/LogServices/EventLog/Entries/ \u003c- LogEntryCollection\n/redfish/v1/Systems/system/LogServices/EventLog/ \u003c- LogService \n/redfish/v1/Systems/system/LogServices/ \u003c- LogServiceCollection\n...",
      "range": {
        "startLine": 2116,
        "startChar": 9,
        "endLine": 2116,
        "endChar": 52
      },
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7564c8b5_3147dad4",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 2116,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-04-26T20:41:06Z",
      "side": 1,
      "message": "\u003e Doesn\u0027t /redfish/v1/AccountService/MultiFactorAuth also need to be implemented?\n\u003e \n\u003e Something doesn\u0027t add up here or my understanding of Redfish is off. \n\u003e I thought all segments in a path should map to a schema. \n\u003e So you could go to a Redfish Route and walk backwards to /redfish/v1/\n\u003e E.g.\n\u003e /redfish/v1/Systems/system/LogServices/EventLog/Entries/141 \u003c- LogEntry \n\u003e /redfish/v1/Systems/system/LogServices/EventLog/Entries/ \u003c- LogEntryCollection\n\u003e /redfish/v1/Systems/system/LogServices/EventLog/ \u003c- LogService \n\u003e /redfish/v1/Systems/system/LogServices/ \u003c- LogServiceCollection\n\u003e ...\n\n\nThis is one of the weird things in the redfish spec that I\u0027ve complained to them before as inconsistent.  Because \"MultiFactorAuth\" is a ComplexType, and not a schema object, it counts as a fragment.  In theory, you\u0027d never go Schema -\u003e Complex -\u003e Schema..... yet there\u0027s a couple places they do, and I think we decided that this is the right behavior to not have a handler for the URI you noticed, because /redfish/v1/AccountService/MultiFactorAuth technically doesn\u0027t exist, and there\u0027s no odata.type we could put there.\n\nYou\u0027re not wrong..... this stuff is confusing, but based on my understanding (which very much could be wrong) this is correct.\n\nYour comment below about not seeing the /redfish/v1/AccountService/MultiFactorAuth/ClientCertificate URL is explained by ClientCertificate being a ComplexType.",
      "parentUuid": "9ca67aea_2abd1780",
      "range": {
        "startLine": 2116,
        "startChar": 9,
        "endLine": 2116,
        "endChar": 52
      },
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e365f298_39e0b9ee",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 2123,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2024-04-26T20:18:49Z",
      "side": 1,
      "message": "Redfish is a hypermedia API. \nI think you need a /redfish/v1/AccountService/MultiFactorAuth/ClientCertificate \n\n\nI see this path here: https://redfish.dmtf.org/schemas/v1/CertificateCollection_v1.xml\n```\n\u003cString\u003e\n/redfish/v1/AccountService/MultiFactorAuth/ClientCertificate/Certificates\n\u003c/String\u003e\n```\nand the below paths at : https://redfish.dmtf.org/schemas/v1/Certificate_v1.xml\n```\n\u003cString\u003e\n/redfish/v1/AccountService/MultiFactorAuth/ClientCertificate/Certificates/{CertificateId}\n\u003c/String\u003e\n```",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "573055f6_bccaed1c",
        "filename": "redfish-core/lib/account_service.hpp",
        "patchSetId": 6
      },
      "lineNbr": 2123,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-04-26T20:41:06Z",
      "side": 1,
      "message": "Let me know if my explanation in the other comment explains this, if not, I can reply directly here.",
      "parentUuid": "e365f298_39e0b9ee",
      "revId": "81c8ac456ca8e59a36d481e6a8edd025a3648a14",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}