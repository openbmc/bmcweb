{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "bec3db5f_ec9b715f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-13T01:00:20Z",
      "side": 1,
      "message": "EventService should be sending Event objects, not message objects.\n\n?\n\nUnless I\u0027m missing something, in which case please link the appropriate part of the spec.",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "46b82e82_1ba34f12",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1001604
      },
      "writtenOn": "2024-11-13T18:08:32Z",
      "side": 1,
      "message": "Agreed. I think it is an event object.\nI changed it to use `EventServiceManager::getInstance().sendEvent()`",
      "parentUuid": "bec3db5f_ec9b715f",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "01a78dc8_b5262593",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1001604
      },
      "writtenOn": "2024-11-14T23:18:07Z",
      "side": 1,
      "message": "https://gerrit.openbmc.org/c/openbmc/bmcweb/+/75791/comment/0164f161_4200e5f9/\n\nAs described in the previous reply to Gunnar\u0027s comment, I\u0027ve changed to send the heartbeat only to the enabled subscriber.",
      "parentUuid": "46b82e82_1ba34f12",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "17b0f829_c52acaae",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-20T15:58:30Z",
      "side": 1,
      "message": "Ok, that\u0027s a start, but how are we testing this if we had tests that passed, but produced the wrong type?  Can we get some level of test procedure documented?",
      "parentUuid": "01a78dc8_b5262593",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15f1b784_f7330a78",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1001604
      },
      "writtenOn": "2024-11-20T21:28:27Z",
      "side": 1,
      "message": "I updated the commit message about tests to monitor heartbeat messages for 1 or multiple subscriber cases.\n\nI think the heartbeat event message content may need to be updated again after dealing with Heartbeat event messaging - https://gerrit.openbmc.org/c/openbmc/bmcweb/+/75791/comment/56ff98be_d494bf8b/",
      "parentUuid": "17b0f829_c52acaae",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fa3bc27d_df3f5da5",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 318,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-13T01:00:20Z",
      "side": 1,
      "message": "I don\u0027t see any handling for PATCH if the user enables/disables heartbeat, the timer should be started/stopped appropriately, right?\n\nCan you please test the patch case?",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "99266ff7_fc11c60f",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 318,
      "author": {
        "id": 1001604
      },
      "writtenOn": "2024-11-13T18:08:32Z",
      "side": 1,
      "message": "Yes, it has been tested.\n\nThis `scheduleNextHeartbeatIfNeeded` is called after PATCH - https://gerrit.openbmc.org/c/openbmc/bmcweb/+/75791/1/redfish-core/lib/event_service.hpp#L886.\n\nThis function cancels `hbTimer` first, and reschedule it if needed.\nI\u0027ll redo the code so that `scheduleNextHeartbeat()` is called only if heartbeat is enabled.",
      "parentUuid": "fa3bc27d_df3f5da5",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7b303d25_3dec4529",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 318,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-20T15:58:30Z",
      "side": 1,
      "message": "üëç",
      "parentUuid": "99266ff7_fc11c60f",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f1c3cda4_996d17eb",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 318,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2024-11-20T18:18:17Z",
      "side": 1,
      "message": "Done. The patch is in the commit msg.",
      "parentUuid": "7b303d25_3dec4529",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "74e4dce4_b10fadd1",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 318,
      "author": {
        "id": 1001604
      },
      "writtenOn": "2024-11-20T19:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7b303d25_3dec4529",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "46ede612_ac0bbe8f",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 326,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-13T01:00:20Z",
      "side": 1,
      "message": "Remove.  If the timer is running, there\u0027s no need to recheck this stuff.  If these change, code needs to appropriately start or stop the timer.",
      "range": {
        "startLine": 322,
        "startChar": 0,
        "endLine": 326,
        "endChar": 9
      },
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4cd552ac_e02f8378",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 326,
      "author": {
        "id": 1001604
      },
      "writtenOn": "2024-11-13T18:08:32Z",
      "side": 1,
      "message": "Currently, this function is invoked also from PATCH (which may be disabling heartbeat) and thus it checks it again.\nHowever, I\u0027m going to restructure the code.",
      "parentUuid": "46ede612_ac0bbe8f",
      "range": {
        "startLine": 322,
        "startChar": 0,
        "endLine": 326,
        "endChar": 9
      },
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ff07c642_bcbbe81b",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 347,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-13T01:00:20Z",
      "side": 1,
      "message": "This looks like it was copied from somewhere else?\n\nPresumably this needs to return?",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ddeb78b0_e48e3ece",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 347,
      "author": {
        "id": 1001604
      },
      "writtenOn": "2024-11-13T18:08:32Z",
      "side": 1,
      "message": "I think we can return if ec \u003d\u003d aborted or operation_cancelled.\nBut the other cases, should we retry like `timer expired`?  (If not, the heartbeat may be stopped due to those errors without any notifications?)",
      "parentUuid": "ff07c642_bcbbe81b",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4e4457ce_870a644b",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 367,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-11-13T01:00:20Z",
      "side": 1,
      "message": "This is going to cause last-event-id to increment, and the logic to be correct.  I think this needs to call eventservicemanager to send the message.\n\nDo heartbeat messages need an ID?",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6898062b_2ef78bf7",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 367,
      "author": {
        "id": 1001604
      },
      "writtenOn": "2024-11-13T18:08:32Z",
      "side": 1,
      "message": "I redo the code to use `EventServiceManager::getInstance().sendEvent()` like\n```\nvoid Subscription::sendHeartbeatEvent()\n{\n    // send the heartbeat message\n    nlohmann::json event \u003d messages::redfishServiceFunctional();\n\n    std::string_view origin{};\n    EventServiceManager::getInstance().sendEvent(event, origin,\n                                                 \"HeartbeatEvent\");\n}\n```",
      "parentUuid": "4e4457ce_870a644b",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2d2c3ed7_9f021f62",
        "filename": "redfish-core/include/event_service_manager.hpp",
        "patchSetId": 1
      },
      "lineNbr": 367,
      "author": {
        "id": 1001604
      },
      "writtenOn": "2024-11-14T23:18:07Z",
      "side": 1,
      "message": "I use Subscription\u0027s `eventSeqNum` as `EventId`, so that it will increment for each event",
      "parentUuid": "6898062b_2ef78bf7",
      "revId": "7b4bbc7cb85732a4ea4d1ccd950d75b4d3d64b8f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}