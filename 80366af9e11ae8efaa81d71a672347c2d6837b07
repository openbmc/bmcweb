{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "25bed17b_888720fa",
        "filename": "/COMMIT_MSG",
        "patchSetId": 21
      },
      "lineNbr": 55,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2023-09-12T19:11:12Z",
      "side": 1,
      "message": "What system was this tested on?  It uses an incorrect association that I don\u0027t see implemented in entity-manager, which would be the only thing capable of publishing a fan-\u003esensor association.  In addition, it\u0027s posting the wrong parameter to Redfish, which I would\u0027ve really expected someone to see if they had actually tried this code.  I\u0027m not sure how this test could\u0027ve passed with the code as written, unless maybe you were doing a unit test?\n\nHelp me understand please.  This appears as if it hasn\u0027t actually been tested, which I\u0027m sure wasn\u0027t your intent.",
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c2b92b0d_df8fac17",
        "filename": "/COMMIT_MSG",
        "patchSetId": 21
      },
      "lineNbr": 55,
      "author": {
        "id": 1001633
      },
      "writtenOn": "2023-09-14T21:46:10Z",
      "side": 1,
      "message": "Thank you for your review. I tested on the Rainier system. Fan associations are implemented in phosphor-hwmon based on what we define in associations.json.\n\nRegarding the Redfish parameters, I understand that there may have been some confusion. Initially, I misunderstood the Redfish schema definition. I believed that \u0027Reading\u0027 represented the current sensor value, while \u0027SpeedRPM\u0027 indicated the fan speed set. As FanSpeed\u0027 could be adjusted by changing the \u0027Target\u0027 value of \u0027xyz.openbmc_project.Control.FanSpeed.\n\n```xyz.openbmc_project.Control.FanSpeed                  interface -         -                                        -\n.Target                                               property  t         10400                                    emits-change writable\nxyz.openbmc_project.Sensor.Value                      interface -         -                                        -\n.MaxValue                                             property  d         inf                                      emits-change writable\n.MinValue                                             property  d         -inf                                     emits-change writable\n.Unit                                                 property  s         \"xyz.openbmc_project.Sensor.Value.Uni... emits-change writable\n.Value                                                property  d         10445                                    emits-change writable```\n\n\nFollowing an internal discussion with Matt Spinler and Gunner, I plan to remove the \u0027Reading\u0027 parameter, as it seems uncertain how to retrieve this value. I will correct the \u0027SpeedRPM\u0027 to the sensor value.",
      "parentUuid": "25bed17b_888720fa",
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bdd54da4_e88da29b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 21
      },
      "lineNbr": 55,
      "author": {
        "id": 1001633
      },
      "writtenOn": "2023-09-15T16:29:42Z",
      "side": 1,
      "message": "Fan sensor associations are defined in associations.json file.\nhttps://github.com/openbmc/openbmc/blob/master/meta-ibm/recipes-phosphor/inventory/phosphor-inventory-manager/associations.json#L94\n\nFan associations are implemented in phosphor-hwmon based on what we define in associations.json.\n\nLatest patch is tested in Witherspoon.",
      "parentUuid": "c2b92b0d_df8fac17",
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3921b289_8d4b80c8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 21
      },
      "lineNbr": 55,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2023-09-18T16:37:44Z",
      "side": 1,
      "message": "Might be good to mention this was tested on Witherspoon in the commit msg. You could also add this link to the associations file. Up to you",
      "parentUuid": "bdd54da4_e88da29b",
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ad650f74_4872aa56",
        "filename": "/COMMIT_MSG",
        "patchSetId": 21
      },
      "lineNbr": 55,
      "author": {
        "id": 1001633
      },
      "writtenOn": "2023-09-19T04:14:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3921b289_8d4b80c8",
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "186cc44a_fe8b9b32",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 381,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2023-09-12T19:11:12Z",
      "side": 1,
      "message": "Need to handle null cases, similar to the existing sensor code.",
      "range": {
        "startLine": 381,
        "startChar": 0,
        "endLine": 381,
        "endChar": 58
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "306f231e_2122ad70",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 381,
      "author": {
        "id": 1001633
      },
      "writtenOn": "2023-09-15T16:29:42Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "186cc44a_fe8b9b32",
      "range": {
        "startLine": 381,
        "startChar": 0,
        "endLine": 381,
        "endChar": 58
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "09a95a32_43e4a0b5",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 381,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2023-09-18T16:37:44Z",
      "side": 1,
      "message": "@Ed are you talking about https://github.com/openbmc/bmcweb/blob/e1bf8bb6a843a2a53d74d74f410b5fe053c2d222/redfish-core/lib/sensors.hpp#L934 ?\n\n```\n            if (!std::isfinite(*doubleValue))\n            {\n                if (valueName \u003d\u003d \"Value\")\n                {\n                    // Readings are allowed to be NAN for unavailable;  coerce\n                    // them to null in the json response.\n                    sensorJson[key] \u003d nullptr;\n                    continue;\n                }\n```",
      "parentUuid": "306f231e_2122ad70",
      "range": {
        "startLine": 381,
        "startChar": 0,
        "endLine": 381,
        "endChar": 58
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0d124f67_7c520787",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 381,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2023-09-18T17:13:55Z",
      "side": 1,
      "message": "Yep, similar to what gunnar posted.  I see a \u003c 0.0 check, which is not what I asked for.  This comment isn\u0027t done.",
      "parentUuid": "09a95a32_43e4a0b5",
      "range": {
        "startLine": 381,
        "startChar": 0,
        "endLine": 381,
        "endChar": 58
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "06a5261e_0490d241",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 381,
      "author": {
        "id": 1001633
      },
      "writtenOn": "2023-09-19T04:14:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0d124f67_7c520787",
      "range": {
        "startLine": 381,
        "startChar": 0,
        "endLine": 381,
        "endChar": 58
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "85e715cb_60f7d7e5",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 381,
      "author": {
        "id": 1000020
      },
      "writtenOn": "2023-09-19T15:51:03Z",
      "side": 1,
      "message": "We just leave it off if it is null? \nThat is different than https://github.com/openbmc/bmcweb/blob/e1bf8bb6a843a2a53d74d74f410b5fe053c2d222/redfish-core/lib/sensors.hpp#L934 but I think that is fine for this commit but can you put that in the commit msg and/or a comment in the code",
      "parentUuid": "06a5261e_0490d241",
      "range": {
        "startLine": 381,
        "startChar": 0,
        "endLine": 381,
        "endChar": 58
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "15f2ab49_73f9d501",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 381,
      "author": {
        "id": 1001633
      },
      "writtenOn": "2023-09-19T16:45:20Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "85e715cb_60f7d7e5",
      "range": {
        "startLine": 381,
        "startChar": 0,
        "endLine": 381,
        "endChar": 58
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5a6ee56a_d8c303f3",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 381,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2023-09-19T16:50:15Z",
      "side": 1,
      "message": "\u003e but I think that is fine for this commit\n\nI don\u0027t, and the more important thing is that this commit completely ignored the existing sensor code that handles this already.  This was discussed with DMTF on how to handle, and what\u0027s in the sensor subsystem is what they said.  I don\u0027t want to lose that, because we already lost it once in the other discussion for sensors.\n\nAlso, it\u0027s a trivial thing to add.  I\u0027m not sure why it\u0027s that difficult to look at the old code.",
      "parentUuid": "15f2ab49_73f9d501",
      "range": {
        "startLine": 381,
        "startChar": 0,
        "endLine": 381,
        "endChar": 58
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f5879b53_b185bcdb",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 391,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2023-09-12T19:11:12Z",
      "side": 1,
      "message": "Target, is different than SpeedRPM.  SpeedRPM is the current reading, Target is the target.  Surely this would\u0027ve shown in your testing that SpeedRPM showed no noise when you ran your tests?",
      "range": {
        "startLine": 391,
        "startChar": 49,
        "endLine": 391,
        "endChar": 55
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "aa44f909_2ca0ef55",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 391,
      "author": {
        "id": 1001633
      },
      "writtenOn": "2023-09-15T16:29:42Z",
      "side": 1,
      "message": "I see that the sensor’s code “Reading” is being set to the “Value” of the sensor.\nI misunderstood the SpeedRPM, but I have now corrected the code.",
      "parentUuid": "f5879b53_b185bcdb",
      "range": {
        "startLine": 391,
        "startChar": 49,
        "endLine": 391,
        "endChar": 55
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "be40fa46_1ffb756c",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 461,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2023-09-12T19:11:12Z",
      "side": 1,
      "message": "This association doesn\u0027t exist anywhere that I see;  I don\u0027t understand how this code could\u0027ve worked as written.",
      "range": {
        "startLine": 461,
        "startChar": 41,
        "endLine": 461,
        "endChar": 48
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "44303843_b768b1e2",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 461,
      "author": {
        "id": 1001633
      },
      "writtenOn": "2023-09-15T16:29:42Z",
      "side": 1,
      "message": "These associations are defined in associations.json file. \nhttps://github.com/openbmc/openbmc/blob/master/meta-ibm/recipes-phosphor/inventory/phosphor-inventory-manager/associations.json#L94",
      "parentUuid": "be40fa46_1ffb756c",
      "range": {
        "startLine": 461,
        "startChar": 41,
        "endLine": 461,
        "endChar": 48
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6f72a601_bee2ff9d",
        "filename": "redfish-core/lib/fan.hpp",
        "patchSetId": 21
      },
      "lineNbr": 461,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2023-09-19T16:59:32Z",
      "side": 1,
      "message": "Why was this resolved?  One systems association does not mean it\u0027s correct.  Also, generally the association we\u0027ve used is \"all_sensors\" so I\u0027m a little surprised phosphor-inventory-manager accepted that.\n\nGiven that a fan very likely has multiple sensors of various classes, just looking for the first related sensor doesn\u0027t work.",
      "parentUuid": "44303843_b768b1e2",
      "range": {
        "startLine": 461,
        "startChar": 41,
        "endLine": 461,
        "endChar": 48
      },
      "revId": "80366af9e11ae8efaa81d71a672347c2d6837b07",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}