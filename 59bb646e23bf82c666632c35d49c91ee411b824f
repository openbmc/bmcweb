{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "35e58842_0ce1502d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 12
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-04-19T00:06:00Z",
      "side": 1,
      "message": "Just realized that this might break stuff for people that don\u0027t have the new query param stuff set.",
      "revId": "59bb646e23bf82c666632c35d49c91ee411b824f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "649a4c05_4de9b10c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 12
      },
      "lineNbr": 0,
      "author": {
        "id": 1000682
      },
      "writtenOn": "2022-04-19T00:45:31Z",
      "side": 1,
      "message": "Oh, yes, any ideas how to resolve it?",
      "parentUuid": "35e58842_0ce1502d",
      "revId": "59bb646e23bf82c666632c35d49c91ee411b824f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac968a77_ee3a2524",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 12
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-04-19T15:47:44Z",
      "side": 1,
      "message": "I need to look at it",
      "parentUuid": "649a4c05_4de9b10c",
      "revId": "59bb646e23bf82c666632c35d49c91ee411b824f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c755f0f7_7ae6e349",
        "filename": "redfish-core/lib/log_services.hpp",
        "patchSetId": 12
      },
      "lineNbr": 1164,
      "author": {
        "id": 1000682
      },
      "writtenOn": "2022-04-19T00:48:37Z",
      "side": 1,
      "message": "When query parameter is not enabled, this will always be a default struct, which means no parameters are delegated, then this code is wrong since $top and $skip are not handled at all.",
      "range": {
        "startLine": 1164,
        "startChar": 31,
        "endLine": 1164,
        "endChar": 45
      },
      "revId": "59bb646e23bf82c666632c35d49c91ee411b824f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "32b83107_3019dffd",
        "filename": "redfish-core/lib/log_services.hpp",
        "patchSetId": 12
      },
      "lineNbr": 1164,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-04-19T15:47:44Z",
      "side": 1,
      "message": "Can you elaborate a little on what you mean?  I\u0027m assuming \"default struct\" means \"default constructed struct with default parameters\"?\n\ntop defaults to size_t::max(), and skip defaults to 0, so even with default arguments, we should still get the desired effect.\n\n\u003e $top and $skip are not handled at all.\n\nI also don\u0027t understand this statement.  Top and skip are handled on line 1266 and 1282.",
      "parentUuid": "c755f0f7_7ae6e349",
      "range": {
        "startLine": 1164,
        "startChar": 31,
        "endLine": 1164,
        "endChar": 45
      },
      "revId": "59bb646e23bf82c666632c35d49c91ee411b824f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "50516ed0_7503c0a8",
        "filename": "redfish-core/lib/log_services.hpp",
        "patchSetId": 12
      },
      "lineNbr": 1164,
      "author": {
        "id": 1000682
      },
      "writtenOn": "2022-04-19T20:34:58Z",
      "side": 1,
      "message": "When redifsh-query is turned off, the returned |delegatedQuery| struct is basically the following\n\n```\nstruct Query\n{\n    // Only\n    bool isOnly \u003d false;\n    // Expand\n    uint8_t expandLevel \u003d 0;\n    ExpandType expandType \u003d ExpandType::None;\n\n    // Skip\n    size_t skip \u003d 0;\n\n    // Top\n    size_t top \u003d std::numeric_limits\u003csize_t\u003e::max();\n};\n```\nBecause we returned early.\nhttps://github.com/openbmc/bmcweb/blob/54417b02efbfe896d6ef442cfc6a721314aac3f8/redfish-core/include/query.hpp#L35\n\nthen the codes here will assume don\u0027t skip any entry and return all entry (top\u003d\u003dmax), right?\n\nFinally the async response just closed without running a new completion handler at https://github.com/openbmc/bmcweb/blob/54417b02efbfe896d6ef442cfc6a721314aac3f8/redfish-core/include/query.hpp#L53.\n\nAs a result, we just ignore $top and $skip in this request. Is that the indented behavior when redifsh-query is off?",
      "parentUuid": "32b83107_3019dffd",
      "range": {
        "startLine": 1164,
        "startChar": 31,
        "endLine": 1164,
        "endChar": 45
      },
      "revId": "59bb646e23bf82c666632c35d49c91ee411b824f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1e7ea9df_578cd205",
        "filename": "redfish-core/lib/log_services.hpp",
        "patchSetId": 12
      },
      "lineNbr": 1164,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-04-19T23:15:54Z",
      "side": 1,
      "message": "\u003e When redifsh-query is turned off, the returned |delegatedQuery| struct is basically the following\n\u003e \n\u003e ```\n\u003e struct Query\n\u003e {\n\u003e     // Only\n\u003e     bool isOnly \u003d false;\n\u003e     // Expand\n\u003e     uint8_t expandLevel \u003d 0;\n\u003e     ExpandType expandType \u003d ExpandType::None;\n\u003e \n\u003e     // Skip\n\u003e     size_t skip \u003d 0;\n\u003e \n\u003e     // Top\n\u003e     size_t top \u003d std::numeric_limits\u003csize_t\u003e::max();\n\u003e };\n\u003e ```\n\u003e Because we returned early.\n\u003e https://github.com/openbmc/bmcweb/blob/54417b02efbfe896d6ef442cfc6a721314aac3f8/redfish-core/include/query.hpp#L35\n\u003e \n\u003e then the codes here will assume don\u0027t skip any entry and return all entry (top\u003d\u003dmax), right?\n\u003e \n\u003e Finally the async response just closed without running a new completion handler at https://github.com/openbmc/bmcweb/blob/54417b02efbfe896d6ef442cfc6a721314aac3f8/redfish-core/include/query.hpp#L53.\n\u003e \n\u003e As a result, we just ignore $top and $skip in this request. Is that the indented behavior when redifsh-query is off?\n\n\nGotcha, yes, this is what I was pointing out in the other comment.  If query params are disabled, and we merge this code, the existing top implementations will break.  I suspect we need to find a solution where $top and $skip are not covered by that check.  I\"m looking into it.",
      "parentUuid": "50516ed0_7503c0a8",
      "range": {
        "startLine": 1164,
        "startChar": 31,
        "endLine": 1164,
        "endChar": 45
      },
      "revId": "59bb646e23bf82c666632c35d49c91ee411b824f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}